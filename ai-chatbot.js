!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ChatBotSDK={})}(this,(function(e){"use strict";var t,n,r,i,o,s,a,l,c,u,d,p={},h=[],f=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,g=Array.isArray;function m(e,t){for(var n in t)e[n]=t[n];return e}function y(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function b(e,t,i,o,s){var a={type:e,props:t,key:i,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==s?++r:s,__i:-1,__u:0};return null==s&&null!=n.vnode&&n.vnode(a),a}function x(e){return e.children}function _(e,t){this.props=e,this.context=t}function k(e,t){if(null==t)return e.__?k(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?k(e):null}function v(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return v(e)}}function w(e){(!e.__d&&(e.__d=!0)&&i.push(e)&&!S.__r++||o!==n.debounceRendering)&&((o=n.debounceRendering)||s)(S)}function S(){for(var e,t,r,o,s,l,c,u=1;i.length;)i.length>u&&i.sort(a),e=i.shift(),u=i.length,e.__d&&(r=void 0,s=(o=(t=e).__v).__e,l=[],c=[],t.__P&&((r=m({},o)).__v=o.__v+1,n.vnode&&n.vnode(r),A(t.__P,r,o,t.__n,t.__P.namespaceURI,32&o.__u?[s]:null,l,null==s?k(o):s,!!(32&o.__u),c),r.__v=o.__v,r.__.__k[r.__i]=r,O(l,r,c),r.__e!=s&&v(r)));S.__r=0}function N(e,t,n,r,i,o,s,a,l,c,u){var d,f,m,y,_,v,w=r&&r.__k||h,S=t.length;for(l=function(e,t,n,r,i){var o,s,a,l,c,u=n.length,d=u,p=0;for(e.__k=new Array(i),o=0;o<i;o++)null!=(s=t[o])&&"boolean"!=typeof s&&"function"!=typeof s?(l=o+p,(s=e.__k[o]="string"==typeof s||"number"==typeof s||"bigint"==typeof s||s.constructor==String?b(null,s,null,null,null):g(s)?b(x,{children:s},null,null,null):void 0===s.constructor&&s.__b>0?b(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s).__=e,s.__b=e.__b+1,a=null,-1!==(c=s.__i=T(s,n,l,d))&&(d--,(a=n[c])&&(a.__u|=2)),null==a||null===a.__v?(-1==c&&(i>u?p--:i<u&&p++),"function"!=typeof s.type&&(s.__u|=4)):c!=l&&(c==l-1?p--:c==l+1?p++:(c>l?p--:p++,s.__u|=4))):e.__k[o]=null;if(d)for(o=0;o<u;o++)null!=(a=n[o])&&!(2&a.__u)&&(a.__e==r&&(r=k(a)),z(a,a));return r}(n,t,w,l,S),d=0;d<S;d++)null!=(m=n.__k[d])&&(f=-1===m.__i?p:w[m.__i]||p,m.__i=d,v=A(e,m,f,i,o,s,a,l,c,u),y=m.__e,m.ref&&f.ref!=m.ref&&(f.ref&&L(f.ref,null,m),u.push(m.ref,m.__c||y,m)),null==_&&null!=y&&(_=y),4&m.__u||f.__k===m.__k?l=E(m,l,e):"function"==typeof m.type&&void 0!==v?l=v:y&&(l=y.nextSibling),m.__u&=-7);return n.__e=_,l}function E(e,t,n){var r,i;if("function"==typeof e.type){for(r=e.__k,i=0;r&&i<r.length;i++)r[i]&&(r[i].__=e,t=E(r[i],t,n));return t}e.__e!=t&&(t&&e.type&&!n.contains(t)&&(t=k(e)),n.insertBefore(e.__e,t||null),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8==t.nodeType);return t}function T(e,t,n,r){var i,o,s=e.key,a=e.type,l=t[n];if(null===l&&null==e.key||l&&s==l.key&&a===l.type&&!(2&l.__u))return n;if(r>(null==l||2&l.__u?0:1))for(i=n-1,o=n+1;i>=0||o<t.length;){if(i>=0){if((l=t[i])&&!(2&l.__u)&&s==l.key&&a===l.type)return i;i--}if(o<t.length){if((l=t[o])&&!(2&l.__u)&&s==l.key&&a===l.type)return o;o++}}return-1}function R(e,t,n){"-"==t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||f.test(t)?n:n+"px"}function I(e,t,n,r,i){var o;e:if("style"==t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||R(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||R(e.style,t,n[t])}else if("o"==t[0]&&"n"==t[1])o=t!=(t=t.replace(l,"$1")),t=t.toLowerCase()in e||"onFocusOut"==t||"onFocusIn"==t?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?r?n.t=r.t:(n.t=c,e.addEventListener(t,o?d:u,o)):e.removeEventListener(t,o?d:u,o);else{if("http://www.w3.org/2000/svg"==i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!=t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==n?"":n))}}function C(e){return function(t){if(this.l){var r=this.l[t.type+e];if(null==t.u)t.u=c++;else if(t.u<r.t)return;return r(n.event?n.event(t):t)}}}function A(e,t,r,i,o,s,a,l,c,u){var d,p,h,f,b,k,v,w,S,E,T,R,I,C,A,O,L,z=t.type;if(void 0!==t.constructor)return null;128&r.__u&&(c=!!(32&r.__u),s=[l=t.__e=r.__e]),(d=n.__b)&&d(t);e:if("function"==typeof z)try{if(w=t.props,S="prototype"in z&&z.prototype.render,E=(d=z.contextType)&&i[d.__c],T=d?E?E.props.value:d.__:i,r.__c?v=(p=t.__c=r.__c).__=p.__E:(S?t.__c=p=new z(w,T):(t.__c=p=new _(w,T),p.constructor=z,p.render=P),E&&E.sub(p),p.props=w,p.state||(p.state={}),p.context=T,p.__n=i,h=p.__d=!0,p.__h=[],p._sb=[]),S&&null==p.__s&&(p.__s=p.state),S&&null!=z.getDerivedStateFromProps&&(p.__s==p.state&&(p.__s=m({},p.__s)),m(p.__s,z.getDerivedStateFromProps(w,p.__s))),f=p.props,b=p.state,p.__v=t,h)S&&null==z.getDerivedStateFromProps&&null!=p.componentWillMount&&p.componentWillMount(),S&&null!=p.componentDidMount&&p.__h.push(p.componentDidMount);else{if(S&&null==z.getDerivedStateFromProps&&w!==f&&null!=p.componentWillReceiveProps&&p.componentWillReceiveProps(w,T),!p.__e&&(null!=p.shouldComponentUpdate&&!1===p.shouldComponentUpdate(w,p.__s,T)||t.__v==r.__v)){for(t.__v!=r.__v&&(p.props=w,p.state=p.__s,p.__d=!1),t.__e=r.__e,t.__k=r.__k,t.__k.some((function(e){e&&(e.__=t)})),R=0;R<p._sb.length;R++)p.__h.push(p._sb[R]);p._sb=[],p.__h.length&&a.push(p);break e}null!=p.componentWillUpdate&&p.componentWillUpdate(w,p.__s,T),S&&null!=p.componentDidUpdate&&p.__h.push((function(){p.componentDidUpdate(f,b,k)}))}if(p.context=T,p.props=w,p.__P=e,p.__e=!1,I=n.__r,C=0,S){for(p.state=p.__s,p.__d=!1,I&&I(t),d=p.render(p.props,p.state,p.context),A=0;A<p._sb.length;A++)p.__h.push(p._sb[A]);p._sb=[]}else do{p.__d=!1,I&&I(t),d=p.render(p.props,p.state,p.context),p.state=p.__s}while(p.__d&&++C<25);p.state=p.__s,null!=p.getChildContext&&(i=m(m({},i),p.getChildContext())),S&&!h&&null!=p.getSnapshotBeforeUpdate&&(k=p.getSnapshotBeforeUpdate(f,b)),O=d,null!=d&&d.type===x&&null==d.key&&(O=M(d.props.children)),l=N(e,g(O)?O:[O],t,r,i,o,s,a,l,c,u),p.base=t.__e,t.__u&=-161,p.__h.length&&a.push(p),v&&(p.__E=p.__=null)}catch(e){if(t.__v=null,c||null!=s)if(e.then){for(t.__u|=c?160:128;l&&8==l.nodeType&&l.nextSibling;)l=l.nextSibling;s[s.indexOf(l)]=null,t.__e=l}else for(L=s.length;L--;)y(s[L]);else t.__e=r.__e,t.__k=r.__k;n.__e(e,t,r)}else null==s&&t.__v==r.__v?(t.__k=r.__k,t.__e=r.__e):l=t.__e=D(r.__e,t,r,i,o,s,a,c,u);return(d=n.diffed)&&d(t),128&t.__u?void 0:l}function O(e,t,r){for(var i=0;i<r.length;i++)L(r[i],r[++i],r[++i]);n.__c&&n.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){n.__e(e,t.__v)}}))}function M(e){return"object"!=typeof e||null==e?e:g(e)?e.map(M):m({},e)}function D(e,r,i,o,s,a,l,c,u){var d,h,f,m,b,x,_,v=i.props,w=r.props,S=r.type;if("svg"==S?s="http://www.w3.org/2000/svg":"math"==S?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),null!=a)for(d=0;d<a.length;d++)if((b=a[d])&&"setAttribute"in b==!!S&&(S?b.localName==S:3==b.nodeType)){e=b,a[d]=null;break}if(null==e){if(null==S)return document.createTextNode(w);e=document.createElementNS(s,S,w.is&&w),c&&(n.__m&&n.__m(r,a),c=!1),a=null}if(null===S)v===w||c&&e.data===w||(e.data=w);else{if(a=a&&t.call(e.childNodes),v=i.props||p,!c&&null!=a)for(v={},d=0;d<e.attributes.length;d++)v[(b=e.attributes[d]).name]=b.value;for(d in v)if(b=v[d],"children"==d);else if("dangerouslySetInnerHTML"==d)f=b;else if(!(d in w)){if("value"==d&&"defaultValue"in w||"checked"==d&&"defaultChecked"in w)continue;I(e,d,null,b,s)}for(d in w)b=w[d],"children"==d?m=b:"dangerouslySetInnerHTML"==d?h=b:"value"==d?x=b:"checked"==d?_=b:c&&"function"!=typeof b||v[d]===b||I(e,d,b,v[d],s);if(h)c||f&&(h.__html===f.__html||h.__html===e.innerHTML)||(e.innerHTML=h.__html),r.__k=[];else if(f&&(e.innerHTML=""),N("template"===r.type?e.content:e,g(m)?m:[m],r,i,o,"foreignObject"==S?"http://www.w3.org/1999/xhtml":s,a,l,a?a[0]:i.__k&&k(i,0),c,u),null!=a)for(d=a.length;d--;)y(a[d]);c||(d="value","progress"==S&&null==x?e.removeAttribute("value"):void 0!==x&&(x!==e[d]||"progress"==S&&!x||"option"==S&&x!==v[d])&&I(e,d,x,v[d],s),d="checked",void 0!==_&&_!==e[d]&&I(e,d,_,v[d],s))}return e}function L(e,t,r){try{if("function"==typeof e){var i="function"==typeof e.__u;i&&e.__u(),i&&null==t||(e.__u=e(t))}else e.current=t}catch(e){n.__e(e,r)}}function z(e,t,r){var i,o;if(n.unmount&&n.unmount(e),(i=e.ref)&&(i.current&&i.current!==e.__e||L(i,null,t)),null!=(i=e.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(e){n.__e(e,t)}i.base=i.__P=null}if(i=e.__k)for(o=0;o<i.length;o++)i[o]&&z(i[o],t,r||"function"!=typeof e.type);r||y(e.__e),e.__c=e.__=e.__e=void 0}function P(e,t,n){return this.constructor(e,n)}function $(e,r,i){var o,s,a,l;r==document&&(r=document.documentElement),n.__&&n.__(e,r),s=(o="function"==typeof i)?null:i&&i.__k||r.__k,a=[],l=[],A(r,e=(!o&&i||r).__k=function(e,n,r){var i,o,s,a={};for(s in n)"key"==s?i=n[s]:"ref"==s?o=n[s]:a[s]=n[s];if(arguments.length>2&&(a.children=arguments.length>3?t.call(arguments,2):r),"function"==typeof e&&null!=e.defaultProps)for(s in e.defaultProps)void 0===a[s]&&(a[s]=e.defaultProps[s]);return b(e,a,i,o,null)}(x,null,[e]),s||p,p,r.namespaceURI,!o&&i?[i]:s?null:r.firstChild?t.call(r.childNodes):null,a,!o&&i?i:s?s.__e:r.firstChild,o,l),O(a,e,l)}t=h.slice,n={__e:function(e,t,n,r){for(var i,o,s;t=t.__;)if((i=t.__c)&&!i.__)try{if((o=i.constructor)&&null!=o.getDerivedStateFromError&&(i.setState(o.getDerivedStateFromError(e)),s=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,r||{}),s=i.__d),s)return i.__E=i}catch(t){e=t}throw e}},r=0,_.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=m({},this.state),"function"==typeof e&&(e=e(m({},n),this.props)),e&&m(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),w(this))},_.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),w(this))},_.prototype.render=x,i=[],s="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,a=function(e,t){return e.__v.__b-t.__v.__b},S.__r=0,l=/(PointerCapture)$|Capture$/i,c=0,u=C(!1),d=C(!0);var B=0;function U(e,t,r,i,o,s){t||(t={});var a,l,c=t;if("ref"in c)for(l in c={},t)"ref"==l?a=t[l]:c[l]=t[l];var u={type:e,props:c,key:r,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--B,__i:-1,__u:0,__source:o,__self:s};if("function"==typeof e&&(a=e.defaultProps))for(l in a)void 0===c[l]&&(c[l]=a[l]);return n.vnode&&n.vnode(u),u}var H="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||{},F="URLSearchParams"in H,j="Symbol"in H&&"iterator"in Symbol,G="FileReader"in H&&"Blob"in H&&function(){try{return new Blob,!0}catch(e){return!1}}(),J="FormData"in H,W="ArrayBuffer"in H;if(W)var q=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],V=ArrayBuffer.isView||function(e){return e&&q.indexOf(Object.prototype.toString.call(e))>-1};function Z(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function Y(e){return"string"!=typeof e&&(e=String(e)),e}function K(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return j&&(t[Symbol.iterator]=function(){return t}),t}function X(e){this.map={},e instanceof X?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function Q(e){if(!e._noBody)return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function ee(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function te(e){var t=new FileReader,n=ee(t);return t.readAsArrayBuffer(e),n}function ne(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function re(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:G&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:J&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:F&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():W&&G&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=ne(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):W&&(ArrayBuffer.prototype.isPrototypeOf(e)||V(e))?this._bodyArrayBuffer=ne(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):F&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},G&&(this.blob=function(){var e=Q(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=Q(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}if(G)return this.blob().then(te);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e,t,n,r,i,o=Q(this);if(o)return o;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=ee(t),r=/charset=([A-Za-z0-9_-]+)/.exec(e.type),i=r?r[1]:"utf-8",t.readAsText(e,i),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},J&&(this.formData=function(){return this.text().then(se)}),this.json=function(){return this.text().then(JSON.parse)},this}X.prototype.append=function(e,t){e=Z(e),t=Y(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},X.prototype.delete=function(e){delete this.map[Z(e)]},X.prototype.get=function(e){return e=Z(e),this.has(e)?this.map[e]:null},X.prototype.has=function(e){return this.map.hasOwnProperty(Z(e))},X.prototype.set=function(e,t){this.map[Z(e)]=Y(t)},X.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},X.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),K(e)},X.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),K(e)},X.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),K(e)},j&&(X.prototype[Symbol.iterator]=X.prototype.entries);var ie=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function oe(e,t){if(!(this instanceof oe))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,r,i=(t=t||{}).body;if(e instanceof oe){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new X(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new X(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),ie.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal||function(){if("AbortController"in H)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(i),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var o=/([?&])_=[^&]*/;if(o.test(this.url))this.url=this.url.replace(o,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function se(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function ae(e,t){if(!(this instanceof ae))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new X(t.headers),this.url=t.url||"",this._initBody(e)}oe.prototype.clone=function(){return new oe(this,{body:this._bodyInit})},re.call(oe.prototype),re.call(ae.prototype),ae.prototype.clone=function(){return new ae(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new X(this.headers),url:this.url})},ae.error=function(){var e=new ae(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var le=[301,302,303,307,308];ae.redirect=function(e,t){if(-1===le.indexOf(t))throw new RangeError("Invalid status code");return new ae(null,{status:t,headers:{location:e}})};var ce=H.DOMException;try{new ce}catch(e){(ce=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),ce.prototype.constructor=ce}function ue(e,t){return new Promise((function(n,r){var i=new oe(e,t);if(i.signal&&i.signal.aborted)return r(new ce("Aborted","AbortError"));var o=new XMLHttpRequest;function s(){o.abort()}if(o.onload=function(){var e,t,r={statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new X,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();try{t.append(r,i)}catch(e){console.warn("Response "+e.message)}}})),t)};0===i.url.indexOf("file://")&&(o.status<200||o.status>599)?r.status=200:r.status=o.status,r.url="responseURL"in o?o.responseURL:r.headers.get("X-Request-URL");var s="response"in o?o.response:o.responseText;setTimeout((function(){n(new ae(s,r))}),0)},o.onerror=function(){setTimeout((function(){r(new TypeError("Network request failed"))}),0)},o.ontimeout=function(){setTimeout((function(){r(new TypeError("Network request timed out"))}),0)},o.onabort=function(){setTimeout((function(){r(new ce("Aborted","AbortError"))}),0)},o.open(i.method,function(e){try{return""===e&&H.location.href?H.location.href:e}catch(t){return e}}(i.url),!0),"include"===i.credentials?o.withCredentials=!0:"omit"===i.credentials&&(o.withCredentials=!1),"responseType"in o&&(G?o.responseType="blob":W&&(o.responseType="arraybuffer")),t&&"object"==typeof t.headers&&!(t.headers instanceof X||H.Headers&&t.headers instanceof H.Headers)){var a=[];Object.getOwnPropertyNames(t.headers).forEach((function(e){a.push(Z(e)),o.setRequestHeader(e,Y(t.headers[e]))})),i.headers.forEach((function(e,t){-1===a.indexOf(t)&&o.setRequestHeader(t,e)}))}else i.headers.forEach((function(e,t){o.setRequestHeader(t,e)}));i.signal&&(i.signal.addEventListener("abort",s),o.onreadystatechange=function(){4===o.readyState&&i.signal.removeEventListener("abort",s)}),o.send(void 0===i._bodyInit?null:i._bodyInit)}))}function de(e){let t,n,r,i=!1;return function(o){void 0===t?(t=o,n=0,r=-1):t=function(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(t,o);const s=t.length;let a=0;for(;n<s;){i&&(10===t[n]&&(a=++n),i=!1);let o=-1;for(;n<s&&-1===o;++n)switch(t[n]){case 58:-1===r&&(r=n-a);break;case 13:i=!0;case 10:o=n}if(-1===o)break;e(t.subarray(a,o),r),a=n,r=-1}a===s?t=void 0:0!==a&&(t=t.subarray(a),n-=a)}}ue.polyfill=!0,H.fetch||(H.fetch=ue,H.Headers=X,H.Request=oe,H.Response=ae);var pe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const he="text/event-stream",fe="last-event-id";function ge(e,t){var{signal:n,headers:r,onopen:i,onmessage:o,onclose:s,onerror:a,openWhenHidden:l,fetch:c}=t,u=pe(t,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise(((t,d)=>{const p=Object.assign({},r);let h;function f(){h.abort(),document.hidden||_()}p.accept||(p.accept=he),l||document.addEventListener("visibilitychange",f);let g=1e3,m=0;function y(){document.removeEventListener("visibilitychange",f),window.clearTimeout(m),h.abort()}null==n||n.addEventListener("abort",(()=>{y(),t()}));const b=null!=c?c:window.fetch,x=null!=i?i:me;async function _(){var n;h=new AbortController;try{const n=await b(e,Object.assign(Object.assign({},u),{headers:p,signal:h.signal}));await x(n),await async function(e,t){const n=e.getReader();let r;for(;!(r=await n.read()).done;)t(r.value)}(n.body,de(function(e,t,n){let r={data:"",event:"",id:"",retry:void 0};const i=new TextDecoder;return function(o,s){if(0===o.length)null==n||n(r),r={data:"",event:"",id:"",retry:void 0};else if(s>0){const n=i.decode(o.subarray(0,s)),a=s+(32===o[s+1]?2:1),l=i.decode(o.subarray(a));switch(n){case"data":r.data=r.data?r.data+"\n"+l:l;break;case"event":r.event=l;break;case"id":e(r.id=l);break;case"retry":const n=parseInt(l,10);isNaN(n)||t(r.retry=n)}}}}((e=>{e?p[fe]=e:delete p[fe]}),(e=>{g=e}),o))),null==s||s(),y(),t()}catch(e){if(!h.signal.aborted)try{const t=null!==(n=null==a?void 0:a(e))&&void 0!==n?n:g;window.clearTimeout(m),m=window.setTimeout(_,t)}catch(e){y(),d(e)}}}_()}))}function me(e){const t=e.headers.get("content-type");if(!(null==t?void 0:t.startsWith(he)))throw new Error(`Expected content-type to be ${he}, Actual: ${t}`)}const ye="#25314b",be="#1F1A24",xe="#FAF9F6",_e="#3498db",ke="rgba(80, 176, 245, 0.8)",ve="#000000",we="#ffffff",Se="#E5E4E2",Ne="#808080",Ee="rgba(234, 51, 63, 0.6)",Te="#898B8E",Re="AI ChatBot",Ie="Ask Anyhing...",Ce="I'm sorry, I don't understand that.",Ae="Oops! Something went wrong. It seems there was an issue processing your request. Please try again, and if the problem persists, feel free to let me know. I'm here to help!",Oe="Start a conversation!",Me="Hi there! How can I assist you today?",De="Loading older messages....",Le="Reset Chat?",ze="Are you sure you want to reset this chat? All current messages and context will be cleared",Pe="Reset",$e="Cancel",Be="Was this helpful?",Ue="How would you rate this chat?",He="Retry",Fe="Regenerate",je="Failed to send.",Ge="Something went wrong.",Je="Error generating a response.";var We,qe;!function(e){e.GET="GET",e.POST="POST",e.PATCH="PATCH",e.DELETE="DELETE"}(We||(We={})),function(e){e.SILENT="silent",e.INFO="info",e.WARN="warn",e.ERROR="error",e.FATAL="fatal"}(qe||(qe={}));const Ve={INVALID_CREDENTIALS:{code:"INVALID_CREDENTIALS",message:"Failed to authenticate given credentials"},NETWORK_ERROR:{code:"NETWORK_ERROR",message:"Failed to fetch data"},GENERIC_API_ERROR:{code:"API_ERROR",message:"Something went wrong"},ERROR_IN_PARSING:{code:"ERROR",message:"Error in parsing the response"},CONFIGURATION_ERROR:{code:"CONFIGURATION_ERROR",message:"Failed to fetch configuration data"},TELEMETRIC_EVENT_ERROR:{code:"FAILED_TO_LOG_TELEMETRIC_EVENT",message:"Telemetric logger function not found in window object"},FETCH_EVENT_SOURCE_ERROR:{code:"FETCH_EVENT_SOURCE_ERROR",message:"Error from microsoft fetchEventSource package"},UNHANDLED_ERROR:{code:"UNHANDLED_ERROR",message:"Unhandled error occurred"}};var Ze;!function(e){e.ERROR="ERROR",e.NETWORK_ERROR="NETWORK_ERROR",e.ERROR_IN_PARSING="ERROR_IN_PARSING",e.INVALID_CREDENTIALS="INVALID_CREDENTIALS",e.CONFIGURATION_ERROR="CONFIGURATION_ERROR",e.GENERIC_API_ERROR="GENERIC_API_ERROR",e.FETCH_EVENT_SOURCE_ERROR="FETCH_EVENT_SOURCE_ERROR",e.UNHANDLED_ERROR="UNHANDLED_ERROR"}(Ze||(Ze={}));const Ye={primaryColor:ve,secondaryColor:_e,chatWindowColor:be,textColor:xe,chatBubbleColor:ke,cardColor:Ee,badgeColor:Te},Ke={chatTitle:Re,chatPlaceholder:Ie,logEnabled:!0,position:{bottom:"40px",right:"30px"},theme:Ye,chatLinkConfig:{openInNewTab:!1},assets:{logo:"https://www.keyvalue.systems/images/favicon.png",banner:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/banner.svg",botIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/botIcon.svg",botIconHover:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/botIconHover.svg",sendIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/sendIcon.svg",closeIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/closeIcon.svg",downIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/downIcon.svg",maximizeIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/maximizeIcon.svg",minimizeIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/minimizeIcon.svg",avatar:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/avatar.svg",closeIconGrey:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/closeIconGrey.svg",leftArrow:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/leftArrow.svg",rightArrow:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/rightArrow.svg",leftIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/leftIcon.svg",rightIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/rightIcon.svg",location:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/location.svg",resetIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/resetIcon.svg",siteIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/siteIcon.svg",thumbsDown:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/thumbsDown.svg",thumbsUp:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/thumbsUp.svg",thumbsDownActive:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/thumbsDownActive.svg",thumbsUpActive:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/thumbsUpActive.svg",closeIconTooltip:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/closeIconTooltip.svg",imagePlaceholder:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/resortImagePlaceholder.svg",bedIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/bedIcon.svg",resetModalCloseIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/resetModalCloseIcon.svg",dateIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/dateIcon.svg",timeIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/timeIcon.svg",brokenImagePlaceholder:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/brokenImagePlaceholder.svg",errorIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/errorIcon.svg",retryIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/retryIcon.svg",regenerateIcon:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/regenerateIcon.svg"}},Xe=[{id:1,label:"Option 1",messagePrompt:"Message prompt for option 1"},{id:2,label:"Option 2",messagePrompt:"Message prompt for option 2"},{id:3,label:"Option 3",messagePrompt:"Message prompt for option 3"},{id:4,label:"Option 4",messagePrompt:"Message prompt for option 4"}];var Qe;!function(e){e[e.INFO=0]="INFO",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN"}(Qe||(Qe={}));const et="Initializing ChatBot UI",tt="Starting conversation",nt="Toggling chat window:",rt="Received complete message from bot:",it="Sending message to bot:",ot="Minimizing chat window",st="Maximizing chat window",at="Unexpected error",lt="Start initializing chat bot",ct="Error initializing ChatBot",ut="API Request timed out, aborting...",dt="Stream closed",pt="Error fetching previous messages",ht="Retry clicked",ft=18e4,gt="bot",mt="error",yt="user",bt="c",xt="Escape",_t="m",kt="ArrowLeft",vt="ArrowRight",wt="api/v1/sites/chatbot/auth",St="api/v1/threads",Nt="api/v1/messages",Et="Minimize",Tt="Maximize",Rt="Close",It="Reset chat",Ct="Send message",At=["bookings"],Ot={event:"events",category:"open AI agent",action:"click",label:"pagename"},Mt={event:"events",category:"AI query selector",action:"click",label:"query name"},Dt={event:"events",category:"close AI agent",action:"click",label:"pagename"},Lt="ADD_NEW_MESSAGE",zt="UPDATE_LAST_MESSAGE",Pt="DELETE_MESSAGE_BY_ID",$t="header",Bt="coverImage",Ut="primaryButton",Ht="markdownText",Ft="normalText",jt="titleSection",Gt="iconLabelList",Jt="keyValueSection",Wt="imageCardList",qt="colorCardSection",Vt="showMoreSection",Zt="HORIZONTAL_LIST",Yt="MATRIX_NX5",Kt="SINGLE";var Xt=/d{1,4}|D{3,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|W{1,2}|[LlopSZN]|"[^"]*"|'[^']*'/g,Qt=/\b(?:[A-Z]{1,3}[A-Z][TC])(?:[-+]\d{4})?|((?:Australian )?(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time)\b/g,en=/[^-+\dA-Z]/g;function tn(e,t,n,r){if(1!==arguments.length||"string"!=typeof e||/\d/.test(e)||(t=e,e=void 0),(e=e||0===e?e:new Date)instanceof Date||(e=new Date(e)),isNaN(e))throw TypeError("Invalid date");var i=(t=String(on[t]||t||on.default)).slice(0,4);"UTC:"!==i&&"GMT:"!==i||(t=t.slice(4),n=!0,"GMT:"===i&&(r=!0));var o=function(){return n?"getUTC":"get"},s=function(){return e[o()+"Date"]()},a=function(){return e[o()+"Day"]()},l=function(){return e[o()+"Month"]()},c=function(){return e[o()+"FullYear"]()},u=function(){return e[o()+"Hours"]()},d=function(){return e[o()+"Minutes"]()},p=function(){return e[o()+"Seconds"]()},h=function(){return e[o()+"Milliseconds"]()},f=function(){return n?0:e.getTimezoneOffset()},g=function(){return cn(e)},m={d:function(){return s()},dd:function(){return an(s())},ddd:function(){return sn.dayNames[a()]},DDD:function(){return ln({y:c(),m:l(),d:s(),_:o(),dayName:sn.dayNames[a()],short:!0})},dddd:function(){return sn.dayNames[a()+7]},DDDD:function(){return ln({y:c(),m:l(),d:s(),_:o(),dayName:sn.dayNames[a()+7]})},m:function(){return l()+1},mm:function(){return an(l()+1)},mmm:function(){return sn.monthNames[l()]},mmmm:function(){return sn.monthNames[l()+12]},yy:function(){return String(c()).slice(2)},yyyy:function(){return an(c(),4)},h:function(){return u()%12||12},hh:function(){return an(u()%12||12)},H:function(){return u()},HH:function(){return an(u())},M:function(){return d()},MM:function(){return an(d())},s:function(){return p()},ss:function(){return an(p())},l:function(){return an(h(),3)},L:function(){return an(Math.floor(h()/10))},t:function(){return u()<12?sn.timeNames[0]:sn.timeNames[1]},tt:function(){return u()<12?sn.timeNames[2]:sn.timeNames[3]},T:function(){return u()<12?sn.timeNames[4]:sn.timeNames[5]},TT:function(){return u()<12?sn.timeNames[6]:sn.timeNames[7]},Z:function(){return r?"GMT":n?"UTC":dn(e)},o:function(){return(f()>0?"-":"+")+an(100*Math.floor(Math.abs(f())/60)+Math.abs(f())%60,4)},p:function(){return(f()>0?"-":"+")+an(Math.floor(Math.abs(f())/60),2)+":"+an(Math.floor(Math.abs(f())%60),2)},S:function(){return["th","st","nd","rd"][s()%10>3?0:(s()%100-s()%10!=10)*s()%10]},W:function(){return g()},WW:function(){return an(g())},N:function(){return un(e)}};return t.replace(Xt,(function(e){return e in m?m[e]():e.slice(1,e.length-1)}))}var nn,rn,on={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",paddedShortDate:"mm/dd/yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},sn={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},an=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return String(e).padStart(t,"0")},ln=function(e){var t=e.y,n=e.m,r=e.d,i=e._,o=e.dayName,s=e.short,a=void 0!==s&&s,l=new Date,c=new Date;c.setDate(c[i+"Date"]()-1);var u=new Date;u.setDate(u[i+"Date"]()+1);return l[i+"FullYear"]()===t&&l[i+"Month"]()===n&&l[i+"Date"]()===r?a?"Tdy":"Today":c[i+"FullYear"]()===t&&c[i+"Month"]()===n&&c[i+"Date"]()===r?a?"Ysd":"Yesterday":u[i+"FullYear"]()===t&&u[i+"Month"]()===n&&u[i+"Date"]()===r?a?"Tmw":"Tomorrow":o},cn=function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var n=new Date(t.getFullYear(),0,4);n.setDate(n.getDate()-(n.getDay()+6)%7+3);var r=t.getTimezoneOffset()-n.getTimezoneOffset();t.setHours(t.getHours()-r);var i=(t-n)/6048e5;return 1+Math.floor(i)},un=function(e){var t=e.getDay();return 0===t&&(t=7),t},dn=function(e){return(String(e).match(Qt)||[""]).pop().replace(en,"").replace(/GMT\+0000/g,"UTC")};!function(e){e.MESSAGES="messages",e.IS_STREAMING="isStreaming",e.THREAD="thread",e.ACTIVE_TABS="activeTabs",e.IS_CHAT_BOT_OPEN="isChatBotOpen",e.EXPIRE_DATE="expireDate",e.LATEST_RATED_MESSAGE="latestRatedMessage",e.LOGGER_ENABLED="loggerEnabled"}(nn||(nn={})),function(e){e.MARKDOWN="markdown",e.JSON="json",e.JSON_TOKEN="json_token",e.ERROR="error"}(rn||(rn={}));const pn="https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/location.svg",hn="https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/siteIcon.svg",fn="https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/dateIcon.svg",gn="headerSection",mn="footerSection",yn="mainContent",bn="header",xn="coverImage",_n="title",kn="iconLabel",vn="primaryButton",wn="chip",Sn="markdownText",Nn="normalText",En="keyValue",Tn="image",Rn="icon",In="titleSection",Cn="iconLabelList",An="keyValueSection",On="imageCardList",Mn="colorCardSection",Dn="showMoreSection",Ln="moreContent",zn="HORIZONTAL_LIST",Pn="MATRIX_NX5",$n="VERTICAL_LIST",Bn="SINGLE",Un=e=>void 0!==e?e:void 0,Hn=(e,t)=>{if(!e||!t)return;return`${new Date(e).toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})} - ${new Date(t).toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})}`},Fn=(e,t)=>{if(e&&t)return`${e} - ${t}`},jn=e=>{if(!e)return null;let t;const n={prefixText:Un(e.prefixText),postfixText:Un(e.postfixText),type:"",layoutType:""};var r,i,o;return e?.resorts?(t=(e=>{const{resort:t,arrival:n,departure:r,guests:i,pets:o}=e?.resortSummary||{};return{data:e.resorts?.map((e=>({options:{showCardNumber:!0},headerSection:{type:gn,list:[{type:xn,src:e?.imageUrl?.[0],alt:e.name}]},mainContent:{type:yn,list:[e.name&&{type:In,title:{type:_n,value:e.name},style:{marginBottom:"8px"}},{type:Cn,items:[e.location&&{type:kn,icon:{type:Rn,src:pn},value:e.location,key:"location"},e.features&&{type:kn,icon:{type:Rn,src:hn},value:e.features,key:"features"}].filter(Boolean)},Un(e.pricePerNight)&&{type:Nn,value:e.pricePerNight}]},footerSection:{type:mn,list:[e.button&&{type:vn,value:Un(e.button.label),style:{color:"#fff",backgroundColor:"#375D77"},action:{src:Un(e.button.url)}}]}})))??[],summary:e?.resortSummary&&{mainContent:{type:yn,list:[{type:In,title:{type:_n,value:"Summary"},style:{marginBottom:"8px"}},{type:An,items:[t&&{type:En,key:"Resort",value:t},n&&{type:En,key:"Arrival",value:n},r&&{type:En,key:"Departure",value:r},i&&{type:En,key:"Guests",value:i},o&&{type:En,key:"Pets",value:o}].filter(Boolean),style:{marginBottom:"10px"}}]}}}})(e),n.type="resorts",n.layoutType=zn):e?.resortCard?(t=(e=>{const{resortCard:t}=e;return{data:{options:{isMoreContent:t?.size?.length>0&&t?.detailedPriceInformation?.length>0},headerSection:{type:gn,list:[{type:bn,value:t?.prefixText,style:{fontSize:"14px",fontWeight:700,lineHeight:"18px"}},{type:xn,src:t?.imageUrl?.[0],alt:t.title}]},mainContent:{type:yn,list:[t?.title&&{type:In,title:{type:_n,value:t.title,style:{fontSize:"14px",fontWeight:600,lineHeight:"18px",marginBottom:"6px"}}},t?.description&&{type:Nn,value:t.description,style:{marginBottom:"6px"}},{type:An,items:[t?.lodgingFeatures&&{type:En,key:"lodgingFeatures",value:t.lodgingFeatures?.join(", ")}].filter(Boolean)}]},moreContent:{type:Ln,list:[{type:An,items:[t?.size&&{type:En,key:"Size",value:t.size}].filter(Boolean)},t.detailedPriceInformation&&{type:Sn,value:t.detailedPriceInformation}]},footerSection:{type:mn,list:[{type:Dn,data:{showMore:{value:"Show More"},showLess:{value:"Show Less"}}}]},layout:{width:"73%"}}}})(e),n.type="resortCard",n.layoutType=Bn):e?.sites?(t=(e=>{const{resort:t,arrival:n,departure:r,guests:i,pets:o}=e?.resortSummary||{};return{data:e.sites?.map((e=>({options:{showCardNumber:!0},headerSection:{list:[{type:xn,src:e?.imageUrl?.[0],alt:e.name}]},mainContent:{type:yn,list:[e.name&&{type:In,title:{type:_n,value:e.name},style:{marginBottom:"8px"}},{type:Cn,items:[e.availableSitesCount&&{type:kn,icon:{type:Rn,src:pn},value:`${e.availableSitesCount} locations available`,key:"location"},e.features&&{type:kn,icon:{type:Rn,src:hn},value:e.features,key:"features"}].filter(Boolean)},Un(e.priceInformation)&&{type:Nn,value:e.priceInformation}]},footerSection:{type:mn,list:[e.button&&{type:vn,value:Un(e.button.label),style:{color:"#fff",backgroundColor:"#375D77"},action:{src:Un(e.button.url)}}]}})))??[],summary:e?.resortSummary&&{mainContent:{type:yn,list:[{type:In,title:{type:_n,value:"Summary"},style:{marginBottom:"8px"}},{type:An,items:[t&&{type:En,key:"Resort",value:t},n&&{type:En,key:"Arrival",value:n},r&&{type:En,key:"Departure",departure:r},i&&{type:En,key:"Guests",value:i},o&&{type:En,key:"Pets",value:o}].filter(Boolean),style:{marginBottom:"10px"}}]}}}})(e),n.type="sites",n.layoutType=zn):e?.trip?(t=(e=>{const{title:t,fromLocation:n,toLocation:r,distance:i,stays:o,estimatedCost:s}=e?.summary||{};return{data:e.trip?.map((e=>({headerSection:{type:gn,list:[{type:xn,src:e.imageUrl,alt:e.title}]},mainContent:{type:yn,list:[e.title&&{type:In,title:{type:_n,value:e.title}},{type:Cn,items:[e.location&&{type:kn,icon:{type:Rn,src:pn},value:e.location,key:"location"},e.stay&&{type:kn,icon:{type:Rn,src:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/bedIcon.svg"},value:e.stay,key:"stay"},e.lodgingFeatures&&{type:kn,icon:{type:Rn,src:hn},value:e.lodgingFeatures?.join(", "),key:"features"}].filter(Boolean)},e.activities?.length>0&&{type:bn,value:"Activities"},{type:On,items:e.activities?.map((e=>({image:e.imageUrl&&{type:Tn,src:e.imageUrl,alt:e.title},title:e.title&&{type:_n,value:e.title},description:e.description&&{type:Sn,value:e.description}})))}]},layout:{width:"210px"}})))??[],summary:e?.summary&&{mainContent:{type:yn,list:[{type:In,title:{type:_n,value:t||"Trip Summary"},style:{marginBottom:"8px"}},{type:An,items:[n&&{type:En,key:"From",value:n},r&&{type:En,key:"From",value:r},i&&{type:En,key:"Distance",value:i},o&&{type:En,key:"Stay",value:o},s&&{type:En,key:"Estimated Cost(Approximately)",value:s}].filter(Boolean),style:{marginBottom:"10px"}}]}}}})(e),n.type="trip",n.layoutType=zn):e?.events?(o=e,t={data:o.events?.map((e=>({mainContent:{type:yn,list:[{type:On,items:[{image:{type:Tn,src:e.imageUrl,alt:e.title},title:{type:_n,value:e.title,style:{marginBottom:"6px"}},iconLabelList:[Hn(e.startDate,e.endDate)&&{type:kn,icon:{type:Rn,src:fn},value:Hn(e.startDate,e.endDate),key:"dateRange"},e.location&&{type:kn,icon:{type:Rn,src:pn},value:e.location,key:"location"}].filter(Boolean)}]}]},layout:{width:"280px",height:"fit-content",minHeight:"80px"}})))??[]},n.type="events",n.layoutType=Pn):e?.eventDetailsCard?(t=(e=>{const t=e.eventDetailsCard;return{data:{options:{isMoreContent:t.eventSchedule?.length>0},headerSection:{type:gn,list:[{type:xn,src:t?.imageUrl,alt:t.title}]},mainContent:{type:yn,list:[t.title&&{type:In,title:{type:_n,value:t.title,style:{fontSize:"13px",lineHeight:"18px"}},style:{marginBottom:"6px"}},{type:Cn,items:[Hn(t.startDate,t.endDate)&&{type:kn,icon:{type:Rn,src:fn},value:Hn(t.startDate,t.endDate),key:"dateRange"},Fn(t.startTime,t.endTime)&&{type:kn,icon:{type:Rn,src:"https://keyvalueai-hvbcade6cfb6ahhy.a01.azurefd.net/keyvalueaiagent/umd/assets/timeIcon.svg"},value:Fn(t.startTime,t.endTime),key:"timeRange"},t.location&&{type:kn,icon:{type:Rn,src:pn},value:t.location,key:"location"}].filter(Boolean),style:{marginBottom:"10px"}},t.aboutEvent&&{type:bn,value:"About Event",style:{marginBottom:"4px"}},t.aboutEvent&&{type:Nn,value:t.aboutEvent}]},moreContent:{type:Ln,list:[t.eventSchedule&&{type:bn,value:"Event Schedule",style:{marginBottom:"6px",marginTop:"4px"}},t.eventSchedule&&{type:Mn,items:t.eventSchedule?.map((e=>({title:{type:_n,value:e.title},description:{type:Sn,value:e.description}}))),style:{gap:"8px"}}]},footerSection:{type:mn,list:[{type:Dn,data:{showMore:{value:"Show More"},showLess:{value:"Show Less"}}}]},layout:{width:"80%"}}}})(e),n.type="eventDetailsCard",n.layoutType=Bn):e?.bookings?"true"===e?.isMultiple?(i=e,t={data:i?.bookings?.map((e=>({mainContent:{type:yn,list:[i?.bookingMessage&&{type:Sn,value:i.bookingMessage}]},footerSection:{type:mn,list:[e.button&&{type:vn,value:Un(e?.button?.label),style:{color:"#fff",backgroundColor:"#375D77"},action:{src:Un(e.button.bookingUrl)}}]}})))},n.type="bookings",n.layoutType=$n):(r=e,t={data:r?.bookings?.map((e=>({mainContent:{type:yn,list:[r?.bookingMessage&&{type:Sn,value:r.bookingMessage}]},footerSection:{type:mn,list:[e.button&&{type:vn,value:Un(e?.button?.label),style:{color:"#fff",backgroundColor:"#375D77"},action:{src:Un(e.button.bookingUrl)}}]}})))},n.type="bookings",n.layoutType=Bn):e?.itineraryData&&(t=(e=>{const{dates:t,travelers:n,stays:r,estimatedCost:i}=e?.itinerarySummary||{};return{data:e?.itineraryData.map((e=>({headerSection:{type:gn,list:[{type:xn,src:e?.imageUrl,alt:e.title}]},mainContent:{type:yn,list:[{type:In,chip:{type:wn,value:e.dayRange,backgroundColor:"#F7EBE1"},title:{type:_n,value:e.title},style:{marginBottom:"8px"}},{type:An,items:[e.stay&&{type:En,key:"Stay",value:e.stay},e.driveTime&&{type:En,key:"Drive time",value:e.driveTime},e.checkInTime&&{type:En,key:"Check-in Time",value:e.checkInTime}].filter(Boolean),style:{marginBottom:"10px"}},e.activities?.length&&{type:bn,value:"Activities",style:{marginBottom:"6px"}},{type:Mn,items:e.activities?.map((e=>({title:{type:_n,value:e.title},description:{type:Sn,value:e.description}})))}]},layout:{width:"210px"}}))),summary:{mainContent:{type:yn,list:[{type:In,title:{type:_n,value:"Summary"},style:{marginBottom:"8px"}},{type:An,items:[t&&{type:En,key:"Dates",value:t},n&&{type:En,key:"Travelers",value:n},r&&{type:En,key:"Stays",value:r?.join(", ")},i&&{type:En,key:"Estimated Cost(approximately)",value:i}].filter(Boolean),style:{marginBottom:"10px"}}]}}}})(e),n.type="itinerary",n.layoutType=zn),{...t,...n}},Gn=({key:e})=>localStorage.getItem(e),Jn=({key:e,value:t})=>{localStorage.setItem(e,t)},Wn=({key:e})=>{localStorage.removeItem(e)},qn={log:async(e,t)=>{const n=(new Date).toISOString(),r=Qe[e].toUpperCase();"true"===Gn({key:"loggerEnabled"})&&console.log(`[${n}] [${r}] ${t}`)},error(e){this.log(Qe.ERROR,e)},info(e){this.log(Qe.INFO,e)},warn(e){this.log(Qe.WARN,e)}},Vn=e=>{const t=[];let n="";return e.forEach((e=>{const r=e.userMessage?.timestamp||e.aiMessage?.timestamp;if(!r)return;const i=(e=>{if(!e)return"";const t=new Date(e),n=new Date,r=new Date(n);return r.setDate(n.getDate()-1),t.toDateString()===n.toDateString()?"Today":t.toDateString()===r.toDateString()?"Yesterday":tn(t,"dd/mm/yyyy")})(r);i&&i!==n&&(t.push({dateMessage:{text:i,timestamp:r,type:"date"}}),n=i),t.push(e)})),t};function Zn(e,...t){for(const n of t)if(n&&"object"==typeof n)for(const t in n)n?.[t]&&"object"==typeof n?.[t]&&!Array.isArray(n?.[t])?e[t]=Zn(e?.[t]||{},n?.[t]||{}):(n?.[t]||"boolean"==typeof n?.[t])&&(e[t]=n?.[t]);return e}const Yn=e=>e&&Object.keys(e).length>0,Kn=e=>Array.isArray(e)&&e.length>0,Xn=e=>"string"==typeof e&&e?.trim().length>0,Qn=()=>window.matchMedia("(max-width: 768px) or (max-height: 667px)").matches,er=e=>"number"==typeof e,tr=(e,t)=>{t?(qn.info(`TELEMETRY EVENT LOG: Custom logger function, ${JSON.stringify(e)}`),t(e)):window?.PushToGTM_global?(qn.info(`TELEMETRY EVENT LOG: ${JSON.stringify(e)}`),window.PushToGTM_global(e)):qn.error(`TELEMETRY EVENT LOG: ${JSON.stringify({...Ve?.TELEMETRIC_EVENT_ERROR,data:e})}`)};const nr=e=>e.reverse().map((e=>{const t={text:e.humanMessage.content,type:yt,timestamp:e.createdAt},n={messageId:e.runId,threadId:e.threadId,text:Xn(e.aiMessage.content)?e.aiMessage.content:Ae,type:gt,timestamp:e.createdAt,feedback:e.feedback,shouldShowFeedback:e.metadata?.shouldShowFeedback,messageStructure:e.aiMessage.type===rn.JSON?rn.JSON_TOKEN:rn.MARKDOWN};return{userMessage:e.humanMessage?.content?t:void 0,aiMessage:n}})),rr=()=>{const e=Gn({key:nn.THREAD});try{return JSON.parse(e||"{}")?.expireDate}catch{qn.warn(Ve[Ze.ERROR_IN_PARSING]?.message)}},ir=()=>{const e=Gn({key:nn.THREAD});try{return JSON.parse(e||"{}")?.threadId}catch{qn.warn(Ve[Ze.ERROR_IN_PARSING]?.message)}},or=(e,t=Lt)=>{const n=Gn({key:nn.MESSAGES})||"[]";if((e?.userMessage?.threadId||e?.aiMessage?.threadId)===ir()||"[]"==n)try{const r=JSON.parse(n);let i=[...r];t===Lt?(5===r.length&&r.shift(),i=[...r,e]):t===zt?(i.pop(),i=[...i,e]):t===Pt&&(i=i?.filter((t=>t?.userMessage?.timestamp!==e?.userMessage?.timestamp))),Jn({key:nn.MESSAGES,value:JSON.stringify(i)})}catch{qn.warn(Ve[Ze.ERROR_IN_PARSING]?.message)}};async function sr(e,t=We.GET,n={}){const r=e=>new Promise((t=>setTimeout(t,e)));for(let o=0;o<=3;o++)try{const r=await fetch(`${e}`,{method:t,headers:{"Content-Type":"application/json"},...(i=n,!(i&&0===Object.keys(i).length)&&{body:JSON.stringify(n)})});return await r.json()||Ce}catch{if(qn.error(JSON.stringify({info:`HTTP error!. Attempt ${o+1} failed.`,...Ve[Ze.NETWORK_ERROR]})),!(o<3))return Ae;await r(1e4)}var i}const ar=async e=>{const{chatId:t="",userMessage:n="",apiUrl:r,headers:i={},timeout:o=ft,onTimeout:s=()=>{},onStreamMessage:a,onStreamMessageError:l}=e,c=new AbortController,u=setTimeout((()=>{qn.warn(ut),c.abort(),s()}),o);try{await ge(r,{method:We.POST,body:JSON.stringify({thread_id:t,message:n}),headers:{"Content-Type":"application/json",...i},signal:c.signal,onmessage(e){a(e)},onerror(e){if(clearTimeout(u),e)throw l(e),Ve[Ze.FETCH_EVENT_SOURCE_ERROR]},onclose(){qn.info(dt),clearTimeout(u)},openWhenHidden:!0})}catch(e){if(e?.code===Ve[Ze.FETCH_EVENT_SOURCE_ERROR]?.code)return;l(Ve[Ze.NETWORK_ERROR]?.message),clearTimeout(u)}};var lr,cr,ur,dr,pr=0,hr=[],fr=n,gr=fr.__b,mr=fr.__r,yr=fr.diffed,br=fr.__c,xr=fr.unmount,_r=fr.__;function kr(e,t){fr.__h&&fr.__h(cr,e,pr||t),pr=0;var n=cr.__H||(cr.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function vr(e){return pr=1,function(e,t,n){var r=kr(lr++,2);if(r.t=e,!r.__c&&(r.__=[n?n(t):Or(void 0,t),function(e){var t=r.__N?r.__N[0]:r.__[0],n=r.t(t,e);t!==n&&(r.__N=[n,r.__[1]],r.__c.setState({}))}],r.__c=cr,!cr.__f)){var i=function(e,t,n){if(!r.__c.__H)return!0;var i=r.__c.__H.__.filter((function(e){return!!e.__c}));if(i.every((function(e){return!e.__N})))return!o||o.call(this,e,t,n);var s=r.__c.props!==e;return i.forEach((function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(s=!0)}})),o&&o.call(this,e,t,n)||s};cr.__f=!0;var o=cr.shouldComponentUpdate,s=cr.componentWillUpdate;cr.componentWillUpdate=function(e,t,n){if(this.__e){var r=o;o=void 0,i(e,t,n),o=r}s&&s.call(this,e,t,n)},cr.shouldComponentUpdate=i}return r.__N||r.__}(Or,e)}function wr(e,t){var n=kr(lr++,3);!fr.__s&&Ar(n.__H,t)&&(n.__=e,n.u=t,cr.__H.__h.push(n))}function Sr(e){return pr=5,Nr((function(){return{current:e}}),[])}function Nr(e,t){var n=kr(lr++,7);return Ar(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function Er(){for(var e;e=hr.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Ir),e.__H.__h.forEach(Cr),e.__H.__h=[]}catch(t){e.__H.__h=[],fr.__e(t,e.__v)}}fr.__b=function(e){cr=null,gr&&gr(e)},fr.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),_r&&_r(e,t)},fr.__r=function(e){mr&&mr(e),lr=0;var t=(cr=e.__c).__H;t&&(ur===cr?(t.__h=[],cr.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0}))):(t.__h.forEach(Ir),t.__h.forEach(Cr),t.__h=[],lr=0)),ur=cr},fr.diffed=function(e){yr&&yr(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==hr.push(t)&&dr===fr.requestAnimationFrame||((dr=fr.requestAnimationFrame)||Rr)(Er)),t.__H.__.forEach((function(e){e.u&&(e.__H=e.u),e.u=void 0}))),ur=cr=null},fr.__c=function(e,t){t.some((function(e){try{e.__h.forEach(Ir),e.__h=e.__h.filter((function(e){return!e.__||Cr(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],fr.__e(n,e.__v)}})),br&&br(e,t)},fr.unmount=function(e){xr&&xr(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{Ir(e)}catch(e){t=e}})),n.__H=void 0,t&&fr.__e(t,n.__v))};var Tr="function"==typeof requestAnimationFrame;function Rr(e){var t,n=function(){clearTimeout(r),Tr&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);Tr&&(t=requestAnimationFrame(n))}function Ir(e){var t=cr,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),cr=t}function Cr(e){var t=cr;e.__c=e.__(),cr=t}function Ar(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function Or(e,t){return"function"==typeof t?t(e):t}function Mr(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}Mr(".chip-button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  border-radius: 22px !important;\n  border: 1px solid;\n  height: 32px;\n  margin-bottom: 8px;\n  border-radius: 10px;\n  font-size: 14px;\n  line-height: 21px;\n  cursor: pointer;\n}\n");const Dr=e=>{const{theme:t=Ye,handleClick:n,item:r}=e,i={chipButton:{borderColor:t?.primaryColor,backgroundColor:t?.chatWindowColor,color:t?.textColor,transition:"background-color 0.3s ease"},chipHover:{borderColor:t?.primaryColor,backgroundColor:t?.primaryColor,color:we,transition:"background-color 0.3s ease"}},[o,s]=vr(i.chipButton);return U("div",{className:"chip-button",style:o,onMouseEnter:()=>s(i.chipHover),onMouseLeave:()=>s(i.chipButton),role:"button",onClick:()=>n(r),children:r.label},r.id)};Mr(".chips-container {\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n}\n\n.chips-content {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n}\n");const Lr=e=>{const{settings:t,onClickActionChip:n,chipsItemsList:r=Xe}=e,i=t?.theme||Ye,o=e=>{const r={...Mt,label:e.label};tr(r,t?.PushToGTM_global),n(e)};return U("div",{className:"chips-container",children:U("div",{className:"chips-content",children:r?.map((e=>U(Dr,{handleClick:o,theme:i,item:e})))})})};var zr,Pr,$r={},Br={};function Ur(){return zr||(zr=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.ALL=e.COLLECTION=e.ATOM=e.SPECIAL=e.INF=e._INFINITY=e.INFINITY=e.NAN=e.BOOL=e.NULL=e.OBJ=e.ARR=e.NUM=e.STR=void 0,e.STR=1,e.NUM=2,e.ARR=4,e.OBJ=8,e.NULL=16,e.BOOL=32,e.NAN=64,e.INFINITY=128,e._INFINITY=256,e.INF=e.INFINITY|e._INFINITY,e.SPECIAL=e.NULL|e.BOOL|e.INF|e.NAN,e.ATOM=e.STR|e.NUM|e.SPECIAL,e.COLLECTION=e.ARR|e.OBJ,e.ALL=e.ATOM|e.COLLECTION,e.Allow={STR:e.STR,NUM:e.NUM,ARR:e.ARR,OBJ:e.OBJ,NULL:e.NULL,BOOL:e.BOOL,NAN:e.NAN,INFINITY:e.INFINITY,_INFINITY:e._INFINITY,INF:e.INF,SPECIAL:e.SPECIAL,ATOM:e.ATOM,COLLECTION:e.COLLECTION,ALL:e.ALL},e.default=e.Allow}(Br)),Br}var Hr=(Pr||(Pr=1,function(e){var t=$r&&$r.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=$r&&$r.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.MalformedJSON=e.PartialJSON=e.parseJSON=e.parse=void 0;const r=Ur();Object.defineProperty(e,"Allow",{enumerable:!0,get:function(){return r.Allow}}),n(Ur(),e);class i extends Error{}e.PartialJSON=i;class o extends Error{}function s(e,t=r.Allow.ALL){if("string"!=typeof e)throw new TypeError("expecting str, got "+typeof e);if(!e.trim())throw new Error(`${e} is empty`);return a(e.trim(),t)}e.MalformedJSON=o,e.parseJSON=s;const a=(e,t)=>{const n=e.length;let s=0;const a=e=>{throw new i(`${e} at position ${s}`)},l=e=>{throw new o(`${e} at position ${s}`)},c=()=>(f(),s>=n&&a("Unexpected end of input"),'"'===e[s]?u():"{"===e[s]?d():"["===e[s]?p():"null"===e.substring(s,s+4)||r.Allow.NULL&t&&n-s<4&&"null".startsWith(e.substring(s))?(s+=4,null):"true"===e.substring(s,s+4)||r.Allow.BOOL&t&&n-s<4&&"true".startsWith(e.substring(s))?(s+=4,!0):"false"===e.substring(s,s+5)||r.Allow.BOOL&t&&n-s<5&&"false".startsWith(e.substring(s))?(s+=5,!1):"Infinity"===e.substring(s,s+8)||r.Allow.INFINITY&t&&n-s<8&&"Infinity".startsWith(e.substring(s))?(s+=8,1/0):"-Infinity"===e.substring(s,s+9)||r.Allow._INFINITY&t&&1<n-s&&n-s<9&&"-Infinity".startsWith(e.substring(s))?(s+=9,-1/0):"NaN"===e.substring(s,s+3)||r.Allow.NAN&t&&n-s<3&&"NaN".startsWith(e.substring(s))?(s+=3,NaN):h()),u=()=>{const i=s;let o=!1;for(s++;s<n&&('"'!==e[s]||o&&"\\"===e[s-1]);)o="\\"===e[s]&&!o,s++;if('"'==e.charAt(s))try{return JSON.parse(e.substring(i,++s-Number(o)))}catch(e){l(String(e))}else if(r.Allow.STR&t)try{return JSON.parse(e.substring(i,s-Number(o))+'"')}catch(t){return JSON.parse(e.substring(i,e.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},d=()=>{s++,f();const i={};try{for(;"}"!==e[s];){if(f(),s>=n&&r.Allow.OBJ&t)return i;const o=u();f(),s++;try{const e=c();i[o]=e}catch(e){if(r.Allow.OBJ&t)return i;throw e}f(),","===e[s]&&s++}}catch(e){if(r.Allow.OBJ&t)return i;a("Expected '}' at end of object")}return s++,i},p=()=>{s++;const n=[];try{for(;"]"!==e[s];)n.push(c()),f(),","===e[s]&&s++}catch(e){if(r.Allow.ARR&t)return n;a("Expected ']' at end of array")}return s++,n},h=()=>{if(0===s){"-"===e&&l("Not sure what '-' is");try{return JSON.parse(e)}catch(n){if(r.Allow.NUM&t)try{return JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(e){}l(String(n))}}const i=s;for("-"===e[s]&&s++;e[s]&&-1===",]}".indexOf(e[s]);)s++;s!=n||r.Allow.NUM&t||a("Unterminated number literal");try{return JSON.parse(e.substring(i,s))}catch(t){"-"===e.substring(i,s)&&a("Not sure what '-' is");try{return JSON.parse(e.substring(i,e.lastIndexOf("e")))}catch(e){l(String(e))}}},f=()=>{for(;s<n&&" \n\r\t".includes(e[s]);)s++};return c()},l=s;e.parse=l}($r)),$r);function Fr(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let jr={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function Gr(e){jr=e}const Jr={exec:()=>null};function Wr(e,t=""){let n="string"==typeof e?e:e.source;const r={replace:(e,t)=>{let i="string"==typeof t?t:t.source;return i=i.replace(qr.caret,"$1"),n=n.replace(e,i),r},getRegex:()=>new RegExp(n,t)};return r}const qr={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[\t ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},Vr=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Zr=/(?:[*+-]|\d{1,9}[.)])/,Yr=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Kr=Wr(Yr).replace(/bull/g,Zr).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Xr=Wr(Yr).replace(/bull/g,Zr).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Qr=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ei=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ti=Wr(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",ei).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ni=Wr(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Zr).getRegex(),ri="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ii=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,oi=Wr("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",ii).replace("tag",ri).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),si=Wr(Qr).replace("hr",Vr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ri).getRegex(),ai={blockquote:Wr(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",si).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:ti,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:Vr,html:oi,lheading:Kr,list:ni,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:si,table:Jr,text:/^[^\n]+/},li=Wr("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Vr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ri).getRegex(),ci={...ai,lheading:Xr,table:li,paragraph:Wr(Qr).replace("hr",Vr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",li).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ri).getRegex()},ui={...ai,html:Wr("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",ii).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Jr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Wr(Qr).replace("hr",Vr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Kr).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},di=/^( {2,}|\\)\n(?!\s*$)/,pi=/[\p{P}\p{S}]/u,hi=/[\s\p{P}\p{S}]/u,fi=/[^\s\p{P}\p{S}]/u,gi=Wr(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,hi).getRegex(),mi=/(?!~)[\p{P}\p{S}]/u,yi=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,bi=Wr(yi,"u").replace(/punct/g,pi).getRegex(),xi=Wr(yi,"u").replace(/punct/g,mi).getRegex(),_i="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",ki=Wr(_i,"gu").replace(/notPunctSpace/g,fi).replace(/punctSpace/g,hi).replace(/punct/g,pi).getRegex(),vi=Wr(_i,"gu").replace(/notPunctSpace/g,/(?:[^\s\p{P}\p{S}]|~)/u).replace(/punctSpace/g,/(?!~)[\s\p{P}\p{S}]/u).replace(/punct/g,mi).getRegex(),wi=Wr("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,fi).replace(/punctSpace/g,hi).replace(/punct/g,pi).getRegex(),Si=Wr(/\\(punct)/,"gu").replace(/punct/g,pi).getRegex(),Ni=Wr(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Ei=Wr(ii).replace("(?:--\x3e|$)","--\x3e").getRegex(),Ti=Wr("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Ei).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ri=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ii=Wr(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Ri).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Ci=Wr(/^!?\[(label)\]\[(ref)\]/).replace("label",Ri).replace("ref",ei).getRegex(),Ai=Wr(/^!?\[(ref)\](?:\[\])?/).replace("ref",ei).getRegex(),Oi={_backpedal:Jr,anyPunctuation:Si,autolink:Ni,blockSkip:/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,br:di,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:Jr,emStrongLDelim:bi,emStrongRDelimAst:ki,emStrongRDelimUnd:wi,escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,link:Ii,nolink:Ai,punctuation:gi,reflink:Ci,reflinkSearch:Wr("reflink|nolink(?!\\()","g").replace("reflink",Ci).replace("nolink",Ai).getRegex(),tag:Ti,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:Jr},Mi={...Oi,link:Wr(/^!?\[(label)\]\((.*?)\)/).replace("label",Ri).getRegex(),reflink:Wr(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ri).getRegex()},Di={...Oi,emStrongRDelimAst:vi,emStrongLDelim:xi,url:Wr(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Li={...Di,br:Wr(di).replace("{2,}","*").getRegex(),text:Wr(Di.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},zi={normal:ai,gfm:ci,pedantic:ui},Pi={normal:Oi,gfm:Di,breaks:Li,pedantic:Mi},$i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Bi=e=>$i[e];function Ui(e,t){if(t){if(qr.escapeTest.test(e))return e.replace(qr.escapeReplace,Bi)}else if(qr.escapeTestNoEncode.test(e))return e.replace(qr.escapeReplaceNoEncode,Bi);return e}function Hi(e){try{e=encodeURI(e).replace(qr.percentDecode,"%")}catch{return null}return e}function Fi(e,t){const n=e.replace(qr.findPipe,((e,t,n)=>{let r=!1,i=t;for(;--i>=0&&"\\"===n[i];)r=!r;return r?"|":" |"})).split(qr.splitPipe);let r=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),t)if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(qr.slashPipe,"|");return n}function ji(e,t,n){const r=e.length;if(0===r)return"";let i=0;for(;i<r;){if(e.charAt(r-i-1)!==t)break;i++}return e.slice(0,r-i)}function Gi(e,t,n,r,i){const o=t.href,s=t.title||null,a=e[1].replace(i.other.outputLinkReplace,"$1");if("!"!==e[0].charAt(0)){r.state.inLink=!0;const e={type:"link",raw:n,href:o,title:s,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,e}return{type:"image",raw:n,href:o,title:s,text:a}}class Ji{options;rules;lexer;constructor(e){this.options=e||jr}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const e=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:ji(e,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],n=function(e,t,n){const r=e.match(n.other.indentCodeCompensation);if(null===r)return t;const i=r[1];return t.split("\n").map((e=>{const t=e.match(n.other.beginningSpace);if(null===t)return e;const[r]=t;return r.length>=i.length?e.slice(i.length):e})).join("\n")}(e,t[3]||"",this.rules);return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(this.rules.other.endingHash.test(e)){const t=ji(e,"#");this.options.pedantic?e=t.trim():t&&!this.rules.other.endingSpaceChar.test(t)||(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:ji(t[0],"\n")}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let e=ji(t[0],"\n").split("\n"),n="",r="";const i=[];for(;e.length>0;){let t=!1;const o=[];let s;for(s=0;s<e.length;s++)if(this.rules.other.blockquoteStart.test(e[s]))o.push(e[s]),t=!0;else{if(t)break;o.push(e[s])}e=e.slice(s);const a=o.join("\n"),l=a.replace(this.rules.other.blockquoteSetextReplace,"\n    $1").replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}\n${a}`:a,r=r?`${r}\n${l}`:l;const c=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(l,i,!0),this.lexer.state.top=c,0===e.length)break;const u=i.at(-1);if("code"===u?.type)break;if("blockquote"===u?.type){const t=u,o=t.raw+"\n"+e.join("\n"),s=this.blockquote(o);i[i.length-1]=s,n=n.substring(0,n.length-t.raw.length)+s.raw,r=r.substring(0,r.length-t.text.length)+s.text;break}if("list"!==u?.type);else{const t=u,o=t.raw+"\n"+e.join("\n"),s=this.list(o);i[i.length-1]=s,n=n.substring(0,n.length-u.raw.length)+s.raw,r=r.substring(0,r.length-t.raw.length)+s.raw,e=o.substring(i.at(-1).raw.length).split("\n")}}return{type:"blockquote",raw:n,tokens:i,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,i={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const o=this.rules.other.listItemRegex(n);let s=!1;for(;e;){let n=!1,r="",a="";if(!(t=o.exec(e)))break;if(this.rules.block.hr.test(e))break;r=t[0],e=e.substring(r.length);let l=t[2].split("\n",1)[0].replace(this.rules.other.listReplaceTabs,(e=>" ".repeat(3*e.length))),c=e.split("\n",1)[0],u=!l.trim(),d=0;if(this.options.pedantic?(d=2,a=l.trimStart()):u?d=t[1].length+1:(d=t[2].search(this.rules.other.nonSpaceChar),d=d>4?1:d,a=l.slice(d),d+=t[1].length),u&&this.rules.other.blankLine.test(c)&&(r+=c+"\n",e=e.substring(c.length+1),n=!0),!n){const t=this.rules.other.nextBulletRegex(d),n=this.rules.other.hrRegex(d),i=this.rules.other.fencesBeginRegex(d),o=this.rules.other.headingBeginRegex(d),s=this.rules.other.htmlBeginRegex(d);for(;e;){const p=e.split("\n",1)[0];let h;if(c=p,this.options.pedantic?(c=c.replace(this.rules.other.listReplaceNesting,"  "),h=c):h=c.replace(this.rules.other.tabCharGlobal,"    "),i.test(c))break;if(o.test(c))break;if(s.test(c))break;if(t.test(c))break;if(n.test(c))break;if(h.search(this.rules.other.nonSpaceChar)>=d||!c.trim())a+="\n"+h.slice(d);else{if(u)break;if(l.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4)break;if(i.test(l))break;if(o.test(l))break;if(n.test(l))break;a+="\n"+c}u||c.trim()||(u=!0),r+=p+"\n",e=e.substring(p.length+1),l=h.slice(d)}}i.loose||(s?i.loose=!0:this.rules.other.doubleBlankLine.test(r)&&(s=!0));let p,h=null;this.options.gfm&&(h=this.rules.other.listIsTask.exec(a),h&&(p="[ ] "!==h[0],a=a.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:r,task:!!h,checked:p,loose:!1,text:a,tokens:[]}),i.raw+=r}const a=i.items.at(-1);if(!a)return;a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd(),i.raw=i.raw.trimEnd();for(let e=0;e<i.items.length;e++)if(this.lexer.state.top=!1,i.items[e].tokens=this.lexer.blockTokens(i.items[e].text,[]),!i.loose){const t=i.items[e].tokens.filter((e=>"space"===e.type)),n=t.length>0&&t.some((e=>this.rules.other.anyLine.test(e.raw)));i.loose=n}if(i.loose)for(let e=0;e<i.items.length;e++)i.items[e].loose=!0;return i}}html(e){const t=this.rules.block.html.exec(e);if(t){return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}}def(e){const t=this.rules.block.def.exec(e);if(t){const e=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:n,title:r}}}table(e){const t=this.rules.block.table.exec(e);if(!t)return;if(!this.rules.other.tableDelimiter.test(t[2]))return;const n=Fi(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split("\n"):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const e of r)this.rules.other.tableAlignRight.test(e)?o.align.push("right"):this.rules.other.tableAlignCenter.test(e)?o.align.push("center"):this.rules.other.tableAlignLeft.test(e)?o.align.push("left"):o.align.push(null);for(let e=0;e<n.length;e++)o.header.push({text:n[e],tokens:this.lexer.inline(n[e]),header:!0,align:o.align[e]});for(const e of i)o.rows.push(Fi(e,o.header.length).map(((e,t)=>({text:e,tokens:this.lexer.inline(e),header:!1,align:o.align[t]}))));return o}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const e="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(e)){if(!this.rules.other.endAngleBracket.test(e))return;const t=ji(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{const e=function(e,t){if(-1===e.indexOf(t[1]))return-1;let n=0;for(let r=0;r<e.length;r++)if("\\"===e[r])r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return-1}(t[2],"()");if(e>-1){const n=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,n).trim(),t[3]=""}}let n=t[2],r="";if(this.options.pedantic){const e=this.rules.other.pedanticHrefTitle.exec(n);e&&(n=e[1],r=e[3])}else r=t[3]?t[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(n=this.options.pedantic&&!this.rules.other.endAngleBracket.test(e)?n.slice(1):n.slice(1,-1)),Gi(t,{href:n?n.replace(this.rules.inline.anyPunctuation,"$1"):n,title:r?r.replace(this.rules.inline.anyPunctuation,"$1"):r},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const e=t[(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," ").toLowerCase()];if(!e){const e=n[0].charAt(0);return{type:"text",raw:e,text:e}}return Gi(n,e,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r)return;if(r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const n=[...r[0]].length-1;let i,o,s=n,a=0;const l="*"===r[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(l.lastIndex=0,t=t.slice(-1*e.length+n);null!=(r=l.exec(t));){if(i=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!i)continue;if(o=[...i].length,r[3]||r[4]){s+=o;continue}if((r[5]||r[6])&&n%3&&!((n+o)%3)){a+=o;continue}if(s-=o,s>0)continue;o=Math.min(o,o+s+a);const t=[...r[0]][0].length,l=e.slice(0,n+r.index+t+o);if(Math.min(n,o)%2){const e=l.slice(1,-1);return{type:"em",raw:l,text:e,tokens:this.lexer.inlineTokens(e)}}const c=l.slice(2,-2);return{type:"strong",raw:l,text:c,tokens:this.lexer.inlineTokens(c)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(this.rules.other.newLineCharGlobal," ");const n=this.rules.other.nonSpaceChar.test(e),r=this.rules.other.startingSpaceChar.test(e)&&this.rules.other.endingSpaceChar.test(e);return n&&r&&(e=e.substring(1,e.length-1)),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let e,n;return"@"===t[2]?(e=t[1],n="mailto:"+e):(e=t[1],n=e),{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let e,n;if("@"===t[2])e=t[0],n="mailto:"+e;else{let r;do{r=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??""}while(r!==t[0]);e=t[0],n="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const e=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:e}}}}class Wi{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||jr,this.options.tokenizer=this.options.tokenizer||new Ji,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:qr,block:zi.normal,inline:Pi.normal};this.options.pedantic?(t.block=zi.pedantic,t.inline=Pi.pedantic):this.options.gfm&&(t.block=zi.gfm,this.options.breaks?t.inline=Pi.breaks:t.inline=Pi.gfm),this.tokenizer.rules=t}static get rules(){return{block:zi,inline:Pi}}static lex(e,t){return new Wi(t).lex(e)}static lexInline(e,t){return new Wi(t).inlineTokens(e)}lex(e){e=e.replace(qr.carriageReturn,"\n"),this.blockTokens(e,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){const t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){for(this.options.pedantic&&(e=e.replace(qr.tabCharGlobal,"    ").replace(qr.spaceLine,""));e;){let r;if(this.options.extensions?.block?.some((n=>!!(r=n.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0))))continue;if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length);const n=t.at(-1);1===r.raw.length&&void 0!==n?n.raw+="\n":t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length);const n=t.at(-1);"paragraph"===n?.type||"text"===n?.type?(n.raw+="\n"+r.raw,n.text+="\n"+r.text,this.inlineQueue.at(-1).src=n.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length);const n=t.at(-1);"paragraph"===n?.type||"text"===n?.type?(n.raw+="\n"+r.raw,n.text+="\n"+r.raw,this.inlineQueue.at(-1).src=n.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}let i=e;if(this.options.extensions?.startBlock){let t=1/0;const n=e.slice(1);let r;this.options.extensions.startBlock.forEach((e=>{r=e.call({lexer:this},n),"number"==typeof r&&r>=0&&(t=Math.min(t,r))})),t<1/0&&t>=0&&(i=e.substring(0,t+1))}if(this.state.top&&(r=this.tokenizer.paragraph(i))){const o=t.at(-1);n&&"paragraph"===o?.type?(o.raw+="\n"+r.raw,o.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):t.push(r),n=i.length!==e.length,e=e.substring(r.raw.length)}else if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length);const n=t.at(-1);"text"===n?.type?(n.raw+="\n"+r.raw,n.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=n.text):t.push(r)}else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n=e,r=null;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(r=this.tokenizer.rules.inline.reflinkSearch.exec(n));)e.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(r=this.tokenizer.rules.inline.blockSkip.exec(n));)n=n.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(r=this.tokenizer.rules.inline.anyPunctuation.exec(n));)n=n.slice(0,r.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let i=!1,o="";for(;e;){let r;if(i||(o=""),i=!1,this.options.extensions?.inline?.some((n=>!!(r=n.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0))))continue;if(r=this.tokenizer.escape(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.tag(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.link(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length);const n=t.at(-1);"text"===r.type&&"text"===n?.type?(n.raw+=r.raw,n.text+=r.text):t.push(r);continue}if(r=this.tokenizer.emStrong(e,n,o)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.codespan(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.br(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.del(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.autolink(e)){e=e.substring(r.raw.length),t.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(e))){e=e.substring(r.raw.length),t.push(r);continue}let s=e;if(this.options.extensions?.startInline){let t=1/0;const n=e.slice(1);let r;this.options.extensions.startInline.forEach((e=>{r=e.call({lexer:this},n),"number"==typeof r&&r>=0&&(t=Math.min(t,r))})),t<1/0&&t>=0&&(s=e.substring(0,t+1))}if(r=this.tokenizer.inlineText(s)){e=e.substring(r.raw.length),"_"!==r.raw.slice(-1)&&(o=r.raw.slice(-1)),i=!0;const n=t.at(-1);"text"===n?.type?(n.raw+=r.raw,n.text+=r.text):t.push(r)}else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return t}}class qi{options;parser;constructor(e){this.options=e||jr}space(e){return""}code({text:e,lang:t,escaped:n}){const r=(t||"").match(qr.notSpaceStart)?.[0],i=e.replace(qr.endingNewline,"")+"\n";return r?'<pre><code class="language-'+Ui(r)+'">'+(n?i:Ui(i,!0))+"</code></pre>\n":"<pre><code>"+(n?i:Ui(i,!0))+"</code></pre>\n"}blockquote({tokens:e}){return`<blockquote>\n${this.parser.parse(e)}</blockquote>\n`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>\n`}hr(e){return"<hr>\n"}list(e){const t=e.ordered,n=e.start;let r="";for(let t=0;t<e.items.length;t++){const n=e.items[t];r+=this.listitem(n)}const i=t?"ol":"ul";return"<"+i+(t&&1!==n?' start="'+n+'"':"")+">\n"+r+"</"+i+">\n"}listitem(e){let t="";if(e.task){const n=this.checkbox({checked:!!e.checked});e.loose?"paragraph"===e.tokens[0]?.type?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&"text"===e.tokens[0].tokens[0].type&&(e.tokens[0].tokens[0].text=n+" "+Ui(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):t+=n+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>\n`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>\n`}table(e){let t="",n="";for(let t=0;t<e.header.length;t++)n+=this.tablecell(e.header[t]);t+=this.tablerow({text:n});let r="";for(let t=0;t<e.rows.length;t++){const i=e.rows[t];n="";for(let e=0;e<i.length;e++)n+=this.tablecell(i[e]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),"<table>\n<thead>\n"+t+"</thead>\n"+r+"</table>\n"}tablerow({text:e}){return`<tr>\n${e}</tr>\n`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>\n`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Ui(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const r=this.parser.parseInline(n),i=Hi(e);if(null===i)return r;let o='<a href="'+(e=i)+'"';return t&&(o+=' title="'+Ui(t)+'"'),o+=">"+r+"</a>",o}image({href:e,title:t,text:n}){const r=Hi(e);if(null===r)return Ui(n);let i=`<img src="${e=r}" alt="${n}"`;return t&&(i+=` title="${Ui(t)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Ui(e.text)}}class Vi{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class Zi{options;renderer;textRenderer;constructor(e){this.options=e||jr,this.options.renderer=this.options.renderer||new qi,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Vi}static parse(e,t){return new Zi(t).parse(e)}static parseInline(e,t){return new Zi(t).parseInline(e)}parse(e,t=!0){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(this.options.extensions?.renderers?.[i.type]){const e=i,t=this.options.extensions.renderers[e.type].call({parser:this},e);if(!1!==t||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(e.type)){n+=t||"";continue}}const o=i;switch(o.type){case"space":n+=this.renderer.space(o);continue;case"hr":n+=this.renderer.hr(o);continue;case"heading":n+=this.renderer.heading(o);continue;case"code":n+=this.renderer.code(o);continue;case"table":n+=this.renderer.table(o);continue;case"blockquote":n+=this.renderer.blockquote(o);continue;case"list":n+=this.renderer.list(o);continue;case"html":n+=this.renderer.html(o);continue;case"paragraph":n+=this.renderer.paragraph(o);continue;case"text":{let i=o,s=this.renderer.text(i);for(;r+1<e.length&&"text"===e[r+1].type;)i=e[++r],s+="\n"+this.renderer.text(i);n+=t?this.renderer.paragraph({type:"paragraph",raw:s,text:s,tokens:[{type:"text",raw:s,text:s,escaped:!0}]}):s;continue}default:{const e='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}parseInline(e,t=this.renderer){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(this.options.extensions?.renderers?.[i.type]){const e=this.options.extensions.renderers[i.type].call({parser:this},i);if(!1!==e||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){n+=e||"";continue}}const o=i;switch(o.type){case"escape":case"text":n+=t.text(o);break;case"html":n+=t.html(o);break;case"link":n+=t.link(o);break;case"image":n+=t.image(o);break;case"strong":n+=t.strong(o);break;case"em":n+=t.em(o);break;case"codespan":n+=t.codespan(o);break;case"br":n+=t.br(o);break;case"del":n+=t.del(o);break;default:{const e='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}}class Yi{options;block;constructor(e){this.options=e||jr}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Wi.lex:Wi.lexInline}provideParser(){return this.block?Zi.parse:Zi.parseInline}}const Ki=new class{defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=Zi;Renderer=qi;TextRenderer=Vi;Lexer=Wi;Tokenizer=Ji;Hooks=Yi;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(const r of e)switch(n=n.concat(t.call(this,r)),r.type){case"table":{const e=r;for(const r of e.header)n=n.concat(this.walkTokens(r.tokens,t));for(const r of e.rows)for(const e of r)n=n.concat(this.walkTokens(e.tokens,t));break}case"list":{const e=r;n=n.concat(this.walkTokens(e.items,t));break}default:{const e=r;this.defaults.extensions?.childTokens?.[e.type]?this.defaults.extensions.childTokens[e.type].forEach((r=>{const i=e[r].flat(1/0);n=n.concat(this.walkTokens(i,t))})):e.tokens&&(n=n.concat(this.walkTokens(e.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach((e=>{const n={...e};if(n.async=this.defaults.async||n.async||!1,e.extensions&&(e.extensions.forEach((e=>{if(!e.name)throw new Error("extension name required");if("renderer"in e){const n=t.renderers[e.name];t.renderers[e.name]=n?function(...t){let r=e.renderer.apply(this,t);return!1===r&&(r=n.apply(this,t)),r}:e.renderer}if("tokenizer"in e){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");const n=t[e.level];n?n.unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&("block"===e.level?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:"inline"===e.level&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}"childTokens"in e&&e.childTokens&&(t.childTokens[e.name]=e.childTokens)})),n.extensions=t),e.renderer){const t=this.defaults.renderer||new qi(this.defaults);for(const n in e.renderer){if(!(n in t))throw new Error(`renderer '${n}' does not exist`);if(["options","parser"].includes(n))continue;const r=n,i=e.renderer[r],o=t[r];t[r]=(...e)=>{let n=i.apply(t,e);return!1===n&&(n=o.apply(t,e)),n||""}}n.renderer=t}if(e.tokenizer){const t=this.defaults.tokenizer||new Ji(this.defaults);for(const n in e.tokenizer){if(!(n in t))throw new Error(`tokenizer '${n}' does not exist`);if(["options","rules","lexer"].includes(n))continue;const r=n,i=e.tokenizer[r],o=t[r];t[r]=(...e)=>{let n=i.apply(t,e);return!1===n&&(n=o.apply(t,e)),n}}n.tokenizer=t}if(e.hooks){const t=this.defaults.hooks||new Yi;for(const n in e.hooks){if(!(n in t))throw new Error(`hook '${n}' does not exist`);if(["options","block"].includes(n))continue;const r=n,i=e.hooks[r],o=t[r];Yi.passThroughHooks.has(n)?t[r]=e=>{if(this.defaults.async)return Promise.resolve(i.call(t,e)).then((e=>o.call(t,e)));const n=i.call(t,e);return o.call(t,n)}:t[r]=(...e)=>{let n=i.apply(t,e);return!1===n&&(n=o.apply(t,e)),n}}n.hooks=t}if(e.walkTokens){const t=this.defaults.walkTokens,r=e.walkTokens;n.walkTokens=function(e){let n=[];return n.push(r.call(this,e)),t&&(n=n.concat(t.call(this,e))),n}}this.defaults={...this.defaults,...n}})),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Wi.lex(e,t??this.defaults)}parser(e,t){return Zi.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{const r={...n},i={...this.defaults,...r},o=this.onError(!!i.silent,!!i.async);if(!0===this.defaults.async&&!1===r.async)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(null==t)return o(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof t)return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=e);const s=i.hooks?i.hooks.provideLexer():e?Wi.lex:Wi.lexInline,a=i.hooks?i.hooks.provideParser():e?Zi.parse:Zi.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(t):t).then((e=>s(e,i))).then((e=>i.hooks?i.hooks.processAllTokens(e):e)).then((e=>i.walkTokens?Promise.all(this.walkTokens(e,i.walkTokens)).then((()=>e)):e)).then((e=>a(e,i))).then((e=>i.hooks?i.hooks.postprocess(e):e)).catch(o);try{i.hooks&&(t=i.hooks.preprocess(t));let e=s(t,i);i.hooks&&(e=i.hooks.processAllTokens(e)),i.walkTokens&&this.walkTokens(e,i.walkTokens);let n=a(e,i);return i.hooks&&(n=i.hooks.postprocess(n)),n}catch(e){return o(e)}}}onError(e,t){return n=>{if(n.message+="\nPlease report this to https://github.com/markedjs/marked.",e){const e="<p>An error occurred:</p><pre>"+Ui(n.message+"",!0)+"</pre>";return t?Promise.resolve(e):e}if(t)return Promise.reject(n);throw n}}};function Xi(e,t){return Ki.parse(e,t)}function Qi(e){return"number"==typeof e}function eo(e){return"string"==typeof e}function to(e){return"boolean"==typeof e}function no(e){return"[object Object]"===Object.prototype.toString.call(e)}function ro(e){return Math.abs(e)}function io(e){return Math.sign(e)}function oo(e,t){return ro(e-t)}function so(e){return po(e).map(Number)}function ao(e){return e[lo(e)]}function lo(e){return Math.max(0,e.length-1)}function co(e,t){return t===lo(e)}function uo(e,t=0){return Array.from(Array(e),((e,n)=>t+n))}function po(e){return Object.keys(e)}function ho(e,t){return[e,t].reduce(((e,t)=>(po(t).forEach((n=>{const r=e[n],i=t[n],o=no(r)&&no(i);e[n]=o?ho(r,i):i})),e)),{})}function fo(e,t){return void 0!==t.MouseEvent&&e instanceof t.MouseEvent}function go(){let e=[];const t={add:function(n,r,i,o={passive:!0}){let s;if("addEventListener"in n)n.addEventListener(r,i,o),s=()=>n.removeEventListener(r,i,o);else{const e=n;e.addListener(i),s=()=>e.removeListener(i)}return e.push(s),t},clear:function(){e=e.filter((e=>e()))}};return t}function mo(e,t,n,r){const i=go(),o=1e3/60;let s=null,a=0,l=0;function c(e){if(!l)return;s||(s=e,n(),n());const i=e-s;for(s=e,a+=i;a>=o;)n(),a-=o;r(a/o),l&&(l=t.requestAnimationFrame(c))}function u(){t.cancelAnimationFrame(l),s=null,a=0,l=0}return{init:function(){i.add(e,"visibilitychange",(()=>{e.hidden&&(s=null,a=0)}))},destroy:function(){u(),i.clear()},start:function(){l||(l=t.requestAnimationFrame(c))},stop:u,update:n,render:r}}function yo(e=0,t=0){const n=ro(e-t);function r(t){return t<e}function i(e){return e>t}function o(e){return r(e)||i(e)}const s={length:n,max:t,min:e,constrain:function(n){return o(n)?r(n)?e:t:n},reachedAny:o,reachedMax:i,reachedMin:r,removeOffset:function(e){return n?e-n*Math.ceil((e-t)/n):e}};return s}function bo(e,t,n){const{constrain:r}=yo(0,e),i=e+1;let o=s(t);function s(e){return n?ro((i+e)%i):r(e)}function a(){return o}function l(){return bo(e,a(),n)}const c={get:a,set:function(e){return o=s(e),c},add:function(e){return l().set(a()+e)},clone:l};return c}function xo(e,t,n,r,i,o,s,a,l,c,u,d,p,h,f,g,m,y,b){const{cross:x,direction:_}=e,k=["INPUT","SELECT","TEXTAREA"],v={passive:!1},w=go(),S=go(),N=yo(50,225).constrain(h.measure(20)),E={mouse:300,touch:400},T={mouse:500,touch:600},R=f?43:25;let I=!1,C=0,A=0,O=!1,M=!1,D=!1,L=!1;function z(e){if(!fo(e,r)&&e.touches.length>=2)return P(e);const t=o.readPoint(e),n=o.readPoint(e,x),s=oo(t,C),l=oo(n,A);if(!M&&!L){if(!e.cancelable)return P(e);if(M=s>l,!M)return P(e)}const u=o.pointerMove(e);s>g&&(D=!0),c.useFriction(.3).useDuration(.75),a.start(),i.add(_(u)),e.preventDefault()}function P(e){const t=u.byDistance(0,!1).index!==d.get(),n=o.pointerUp(e)*(f?T:E)[L?"mouse":"touch"],r=function(e,t){const n=d.add(-1*io(e)),r=u.byDistance(e,!f).distance;return f||ro(e)<N?r:m&&t?.5*r:u.byIndex(n.get(),0).distance}(_(n),t),i=function(e,t){if(0===e||0===t)return 0;if(ro(e)<=ro(t))return 0;const n=oo(ro(e),ro(t));return ro(n/e)}(n,r),s=R-10*i,a=y+i/50;M=!1,O=!1,S.clear(),c.useDuration(s).useFriction(a),l.distance(r,!f),L=!1,p.emit("pointerUp")}function $(e){D&&(e.stopPropagation(),e.preventDefault(),D=!1)}return{init:function(e){if(!b)return;function a(a){(to(b)||b(e,a))&&function(e){const a=fo(e,r);if(L=a,D=f&&a&&!e.buttons&&I,I=oo(i.get(),s.get())>=2,a&&0!==e.button)return;if(function(e){const t=e.nodeName||"";return k.includes(t)}(e.target))return;O=!0,o.pointerDown(e),c.useFriction(0).useDuration(0),i.set(s),function(){const e=L?n:t;S.add(e,"touchmove",z,v).add(e,"touchend",P).add(e,"mousemove",z,v).add(e,"mouseup",P)}(),C=o.readPoint(e),A=o.readPoint(e,x),p.emit("pointerDown")}(a)}const l=t;w.add(l,"dragstart",(e=>e.preventDefault()),v).add(l,"touchmove",(()=>{}),v).add(l,"touchend",(()=>{})).add(l,"touchstart",a).add(l,"mousedown",a).add(l,"touchcancel",P).add(l,"contextmenu",P).add(l,"click",$,!0)},destroy:function(){w.clear(),S.clear()},pointerDown:function(){return O}}}function _o(e,t){let n,r;function i(e){return e.timeStamp}function o(n,r){const i="client"+("x"===(r||e.scroll)?"X":"Y");return(fo(n,t)?n:n.touches[0])[i]}return{pointerDown:function(e){return n=e,r=e,o(e)},pointerMove:function(e){const t=o(e)-o(r),s=i(e)-i(n)>170;return r=e,s&&(n=e),t},pointerUp:function(e){if(!n||!r)return 0;const t=o(r)-o(n),s=i(e)-i(n),a=i(e)-i(r)>170,l=t/s;return s&&!a&&ro(l)>.1?l:0},readPoint:o}}function ko(e,t,n,r,i,o,s){const a=[e].concat(r);let l,c,u=[],d=!1;function p(e){return i.measureSize(s.measure(e))}return{init:function(i){o&&(c=p(e),u=r.map(p),l=new ResizeObserver((n=>{(to(o)||o(i,n))&&function(n){for(const o of n){if(d)return;const n=o.target===e,s=r.indexOf(o.target),a=n?c:u[s];if(ro(p(n?e:r[s])-a)>=.5){i.reInit(),t.emit("resize");break}}}(n)})),n.requestAnimationFrame((()=>{a.forEach((e=>l.observe(e)))})))},destroy:function(){d=!0,l&&l.disconnect()}}}function vo(e,t,n,r,i){const o=i.measure(10),s=i.measure(50),a=yo(.1,.99);let l=!1;function c(){return!l&&(!!e.reachedAny(n.get())&&!!e.reachedAny(t.get()))}return{shouldConstrain:c,constrain:function(i){if(!c())return;const l=e.reachedMin(t.get())?"min":"max",u=ro(e[l]-t.get()),d=n.get()-t.get(),p=a.constrain(u/s);n.subtract(d*p),!i&&ro(d)<o&&(n.set(e.constrain(n.get())),r.useDuration(25).useBaseFriction())},toggleActive:function(e){l=!e}}}function wo(e,t,n,r){const i=t.min+.1,o=t.max+.1,{reachedMin:s,reachedMax:a}=yo(i,o);const l={loop:function(t){if(!function(e){return 1===e?a(n.get()):-1===e&&s(n.get())}(t))return;const i=e*(-1*t);r.forEach((e=>e.add(i)))}};return l}function So(e,t,n,r,i){const{reachedAny:o,removeOffset:s,constrain:a}=r;function l(e){return e.concat().sort(((e,t)=>ro(e)-ro(t)))[0]}function c(t,r){const i=[t,t+n,t-n];if(!e)return t;if(!r)return l(i);const o=i.filter((e=>io(e)===r));return o.length?l(o):ao(i)-n}return{byDistance:function(n,r){const l=i.get()+n,{index:u,distance:d}=function(n){const r=e?s(n):a(n),i=t.map(((e,t)=>({diff:c(e-r,0),index:t}))).sort(((e,t)=>ro(e.diff)-ro(t.diff))),{index:o}=i[0];return{index:o,distance:r}}(l),p=!e&&o(l);return!r||p?{index:u,distance:n}:{index:u,distance:n+c(t[u]-d,0)}},byIndex:function(e,n){return{index:e,distance:c(t[e]-i.get(),n)}},shortcut:c}}function No(e,t,n,r,i,o,s,a){const l={passive:!0,capture:!0};let c=0;function u(e){"Tab"===e.code&&(c=(new Date).getTime())}return{init:function(d){a&&(o.add(document,"keydown",u,!1),t.forEach(((t,u)=>{o.add(t,"focus",(t=>{(to(a)||a(d,t))&&function(t){if((new Date).getTime()-c>10)return;s.emit("slideFocusStart"),e.scrollLeft=0;const o=n.findIndex((e=>e.includes(t)));Qi(o)&&(i.useDuration(0),r.index(o,0),s.emit("slideFocus"))}(u)}),l)})))}}}function Eo(e){let t=e;function n(e){return Qi(e)?e:e.get()}const r={get:function(){return t},set:function(e){t=n(e)},add:function(e){t+=n(e)},subtract:function(e){t-=n(e)}};return r}function To(e,t){const n="x"===e.scroll?function(e){return`translate3d(${e}px,0px,0px)`}:function(e){return`translate3d(0px,${e}px,0px)`},r=t.style;let i=null,o=!1;return{clear:function(){o||(r.transform="",t.getAttribute("style")||t.removeAttribute("style"))},to:function(t){if(o)return;const s=(a=e.direction(t),Math.round(100*a)/100);var a;s!==i&&(r.transform=n(s),i=s)},toggleActive:function(e){o=!e}}}function Ro(e,t,n,r,i,o,s,a,l){const c=so(i),u=so(i).reverse(),d=function(){const e=s[0];return f(h(u,e),n,!1)}().concat(function(){const e=t-s[0]-1;return f(h(c,e),-n,!0)}());function p(e,t){return e.reduce(((e,t)=>e-i[t]),t)}function h(e,t){return e.reduce(((e,n)=>p(e,t)>0?e.concat([n]):e),[])}function f(i,s,c){const u=function(e){return o.map(((n,i)=>({start:n-r[i]+.5+e,end:n+t-.5+e})))}(s);return i.map((t=>{const r=c?0:-n,i=c?n:0,o=c?"end":"start",s=u[t][o];return{index:t,loopPoint:s,slideLocation:Eo(-1),translate:To(e,l[t]),target:()=>a.get()>s?r:i}}))}const g={canLoop:function(){return d.every((({index:e})=>{const n=c.filter((t=>t!==e));return p(n,t)<=.1}))},clear:function(){d.forEach((e=>e.translate.clear()))},loop:function(){d.forEach((e=>{const{target:t,translate:n,slideLocation:r}=e,i=t();i!==r.get()&&(n.to(i),r.set(i))}))},loopPoints:d};return g}function Io(e,t,n){let r,i=!1;return{init:function(o){n&&(r=new MutationObserver((e=>{i||(to(n)||n(o,e))&&function(e){for(const n of e)if("childList"===n.type){o.reInit(),t.emit("slidesChanged");break}}(e)})),r.observe(e,{childList:!0}))},destroy:function(){r&&r.disconnect(),i=!0}}}function Co(e,t,n,r){const i={};let o,s=null,a=null,l=!1;const c={init:function(){o=new IntersectionObserver((e=>{l||(e.forEach((e=>{const n=t.indexOf(e.target);i[n]=e})),s=null,a=null,n.emit("slidesInView"))}),{root:e.parentElement,threshold:r}),t.forEach((e=>o.observe(e)))},destroy:function(){o&&o.disconnect(),l=!0},get:function(e=!0){if(e&&s)return s;if(!e&&a)return a;const t=function(e){return po(i).reduce(((t,n)=>{const r=parseInt(n),{isIntersecting:o}=i[r];return(e&&o||!e&&!o)&&t.push(r),t}),[])}(e);return e&&(s=t),e||(a=t),t}};return c}function Ao(e,t,n,r,i,o,s,a,l){const{startEdge:c,endEdge:u,direction:d}=e,p=Qi(n);const h={groupSlides:function(e){return p?function(e,t){return so(e).filter((e=>e%t==0)).map((n=>e.slice(n,n+t)))}(e,n):function(e){return e.length?so(e).reduce(((n,p,h)=>{const f=ao(n)||0,g=0===f,m=p===lo(e),y=i[c]-o[f][c],b=i[c]-o[p][u],x=!r&&g?d(s):0,_=ro(b-(!r&&m?d(a):0)-(y+x));return h&&_>t+l&&n.push(p),m&&n.push(e.length),n}),[]).map(((t,n,r)=>{const i=Math.max(r[n-1]||0);return e.slice(i,t)})):[]}(e)}};return h}function Oo(e,t,n,r,i,o,s){const{align:a,axis:l,direction:c,startIndex:u,loop:d,duration:p,dragFree:h,dragThreshold:f,inViewThreshold:g,slidesToScroll:m,skipSnaps:y,containScroll:b,watchResize:x,watchSlides:_,watchDrag:k,watchFocus:v}=o,w={measure:function(e){const{offsetTop:t,offsetLeft:n,offsetWidth:r,offsetHeight:i}=e;return{top:t,right:n+r,bottom:t+i,left:n,width:r,height:i}}},S=w.measure(t),N=n.map(w.measure),E=function(e,t){const n="rtl"===t,r="y"===e,i=!r&&n?-1:1,o={scroll:r?"y":"x",cross:r?"x":"y",startEdge:r?"top":n?"right":"left",endEdge:r?"bottom":n?"left":"right",measureSize:function(e){const{height:t,width:n}=e;return r?t:n},direction:function(e){return e*i}};return o}(l,c),T=E.measureSize(S),R=function(e){const t={measure:function(t){return e*(t/100)}};return t}(T),I=function(e,t){const n={start:function(){return 0},center:function(e){return r(e)/2},end:r};function r(e){return t-e}const i={measure:function(r,i){return eo(e)?n[e](r):e(t,r,i)}};return i}(a,T),C=!d&&!!b,A=d||!!b,{slideSizes:O,slideSizesWithGaps:M,startGap:D,endGap:L}=function(e,t,n,r,i,o){const{measureSize:s,startEdge:a,endEdge:l}=e,c=n[0]&&i,u=function(){if(!c)return 0;const e=n[0];return ro(t[a]-e[a])}(),d=function(){if(!c)return 0;const e=o.getComputedStyle(ao(r));return parseFloat(e.getPropertyValue(`margin-${l}`))}(),p=n.map(s),h=n.map(((e,t,n)=>{const r=!t,i=co(n,t);return r?p[t]+u:i?p[t]+d:n[t+1][a]-e[a]})).map(ro);return{slideSizes:p,slideSizesWithGaps:h,startGap:u,endGap:d}}(E,S,N,n,A,i),z=Ao(E,T,m,d,S,N,D,L,2),{snaps:P,snapsAligned:$}=function(e,t,n,r,i){const{startEdge:o,endEdge:s}=e,{groupSlides:a}=i,l=a(r).map((e=>ao(e)[s]-e[0][o])).map(ro).map(t.measure),c=r.map((e=>n[o]-e[o])).map((e=>-ro(e))),u=a(c).map((e=>e[0])).map(((e,t)=>e+l[t]));return{snaps:c,snapsAligned:u}}(E,I,S,N,z),B=-ao(P)+ao(M),{snapsContained:U,scrollContainLimit:H}=function(e,t,n,r,i){const o=yo(-t+e,0),s=n.map(((e,t)=>{const{min:r,max:i}=o,s=o.constrain(e),a=!t,c=co(n,t);return a?i:c||l(r,s)?r:l(i,s)?i:s})).map((e=>parseFloat(e.toFixed(3)))),a=function(){const e=s[0],t=ao(s);return yo(s.lastIndexOf(e),s.indexOf(t)+1)}();function l(e,t){return oo(e,t)<=1}return{snapsContained:function(){if(t<=e+i)return[o.max];if("keepSnaps"===r)return s;const{min:n,max:l}=a;return s.slice(n,l)}(),scrollContainLimit:a}}(T,B,$,b,2),F=C?U:$,{limit:j}=function(e,t,n){const r=t[0];return{limit:yo(n?r-e:ao(t),r)}}(B,F,d),G=bo(lo(F),u,d),J=G.clone(),W=so(n),q=mo(r,i,(()=>(({dragHandler:e,scrollBody:t,scrollBounds:n,options:{loop:r}})=>{r||n.constrain(e.pointerDown()),t.seek()})(ae)),(e=>(({scrollBody:e,translate:t,location:n,offsetLocation:r,previousLocation:i,scrollLooper:o,slideLooper:s,dragHandler:a,animation:l,eventHandler:c,scrollBounds:u,options:{loop:d}},p)=>{const h=e.settled(),f=!u.shouldConstrain(),g=d?h:h&&f;g&&!a.pointerDown()&&(l.stop(),c.emit("settle")),g||c.emit("scroll");const m=n.get()*p+i.get()*(1-p);r.set(m),d&&(o.loop(e.direction()),s.loop()),t.to(r.get())})(ae,e))),V=F[G.get()],Z=Eo(V),Y=Eo(V),K=Eo(V),X=Eo(V),Q=function(e,t,n,r,i,o){let s=0,a=0,l=i,c=o,u=e.get(),d=0;function p(e){return l=e,f}function h(e){return c=e,f}const f={direction:function(){return a},duration:function(){return l},velocity:function(){return s},seek:function(){const t=r.get()-e.get();let i=0;return l?(n.set(e),s+=t/l,s*=c,u+=s,e.add(s),i=u-d):(s=0,n.set(r),e.set(r),i=t),a=io(i),d=u,f},settled:function(){return ro(r.get()-t.get())<.001},useBaseFriction:function(){return h(o)},useBaseDuration:function(){return p(i)},useFriction:h,useDuration:p};return f}(Z,K,Y,X,p,.68),ee=So(d,F,B,j,X),te=function(e,t,n,r,i,o,s){function a(i){const a=i.distance,l=i.index!==t.get();o.add(a),a&&(r.duration()?e.start():(e.update(),e.render(1),e.update())),l&&(n.set(t.get()),t.set(i.index),s.emit("select"))}const l={distance:function(e,t){a(i.byDistance(e,t))},index:function(e,n){const r=t.clone().set(e);a(i.byIndex(r.get(),n))}};return l}(q,G,J,Q,ee,X,s),ne=function(e){const{max:t,length:n}=e,r={get:function(e){return n?(e-t)/-n:0}};return r}(j),re=go(),ie=Co(t,n,s,g),{slideRegistry:oe}=function(e,t,n,r,i,o){const{groupSlides:s}=i,{min:a,max:l}=r;return{slideRegistry:function(){const r=s(o),i=!e||"keepSnaps"===t;return 1===n.length?[o]:i?r:r.slice(a,l).map(((e,t,n)=>{const r=!t,i=co(n,t);return r?uo(ao(n[0])+1):i?uo(lo(o)-ao(n)[0]+1,ao(n)[0]):e}))}()}}(C,b,F,H,z,W),se=No(e,n,oe,te,Q,re,s,v),ae={ownerDocument:r,ownerWindow:i,eventHandler:s,containerRect:S,slideRects:N,animation:q,axis:E,dragHandler:xo(E,e,r,i,X,_o(E,i),Z,q,te,Q,ee,G,s,R,h,f,y,.68,k),eventStore:re,percentOfView:R,index:G,indexPrevious:J,limit:j,location:Z,offsetLocation:K,previousLocation:Y,options:o,resizeHandler:ko(t,s,i,n,E,x,w),scrollBody:Q,scrollBounds:vo(j,K,X,Q,R),scrollLooper:wo(B,j,K,[Z,K,Y,X]),scrollProgress:ne,scrollSnapList:F.map(ne.get),scrollSnaps:F,scrollTarget:ee,scrollTo:te,slideLooper:Ro(E,T,B,O,M,P,F,K,n),slideFocus:se,slidesHandler:Io(t,s,_),slidesInView:ie,slideIndexes:W,slideRegistry:oe,slidesToScroll:z,target:X,translate:To(E,t)};return ae}Xi.options=Xi.setOptions=function(e){return Ki.setOptions(e),Xi.defaults=Ki.defaults,Gr(Xi.defaults),Xi},Xi.getDefaults=Fr,Xi.defaults=jr,Xi.use=function(...e){return Ki.use(...e),Xi.defaults=Ki.defaults,Gr(Xi.defaults),Xi},Xi.walkTokens=function(e,t){return Ki.walkTokens(e,t)},Xi.parseInline=Ki.parseInline,Xi.Parser=Zi,Xi.parser=Zi.parse,Xi.Renderer=qi,Xi.TextRenderer=Vi,Xi.Lexer=Wi,Xi.lexer=Wi.lex,Xi.Tokenizer=Ji,Xi.Hooks=Yi,Xi.parse=Xi,Xi.options,Xi.setOptions,Xi.use,Xi.walkTokens,Xi.parseInline,Zi.parse,Wi.lex;const Mo={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function Do(e){function t(e,t){return ho(e,t||{})}const n={mergeOptions:t,optionsAtMedia:function(n){const r=n.breakpoints||{},i=po(r).filter((t=>e.matchMedia(t).matches)).map((e=>r[e])).reduce(((e,n)=>t(e,n)),{});return t(n,i)},optionsMediaQueries:function(t){return t.map((e=>po(e.breakpoints||{}))).reduce(((e,t)=>e.concat(t)),[]).map(e.matchMedia)}};return n}function Lo(e,t,n){const r=e.ownerDocument,i=r.defaultView,o=Do(i),s=function(e){let t=[];const n={init:function(n,r){return t=r.filter((({options:t})=>!1!==e.optionsAtMedia(t).active)),t.forEach((t=>t.init(n,e))),r.reduce(((e,t)=>Object.assign(e,{[t.name]:t})),{})},destroy:function(){t=t.filter((e=>e.destroy()))}};return n}(o),a=go(),l=function(){let e,t={};function n(e){return t[e]||[]}const r={init:function(t){e=t},emit:function(t){return n(t).forEach((n=>n(e,t))),r},off:function(e,i){return t[e]=n(e).filter((e=>e!==i)),r},on:function(e,i){return t[e]=n(e).concat([i]),r},clear:function(){t={}}};return r}(),{mergeOptions:c,optionsAtMedia:u,optionsMediaQueries:d}=o,{on:p,off:h,emit:f}=l,g=E;let m,y,b,x,_=!1,k=c(Mo,Lo.globalOptions),v=c(k),w=[];function S(t){const n=Oo(e,b,x,r,i,t,l);if(t.loop&&!n.slideLooper.canLoop()){return S(Object.assign({},t,{loop:!1}))}return n}function N(t,n){_||(k=c(k,t),v=u(k),w=n||w,function(){const{container:t,slides:n}=v,r=eo(t)?e.querySelector(t):t;b=r||e.children[0];const i=eo(n)?b.querySelectorAll(n):n;x=[].slice.call(i||b.children)}(),m=S(v),d([k,...w.map((({options:e})=>e))]).forEach((e=>a.add(e,"change",E))),v.active&&(m.translate.to(m.location.get()),m.animation.init(),m.slidesInView.init(),m.slideFocus.init(C),m.eventHandler.init(C),m.resizeHandler.init(C),m.slidesHandler.init(C),m.options.loop&&m.slideLooper.loop(),b.offsetParent&&x.length&&m.dragHandler.init(C),y=s.init(C,w)))}function E(e,t){const n=I();T(),N(c({startIndex:n},e),t),l.emit("reInit")}function T(){m.dragHandler.destroy(),m.eventStore.clear(),m.translate.clear(),m.slideLooper.clear(),m.resizeHandler.destroy(),m.slidesHandler.destroy(),m.slidesInView.destroy(),m.animation.destroy(),s.destroy(),a.clear()}function R(e,t,n){v.active&&!_&&(m.scrollBody.useBaseFriction().useDuration(!0===t?0:v.duration),m.scrollTo.index(e,n||0))}function I(){return m.index.get()}const C={canScrollNext:function(){return m.index.add(1).get()!==I()},canScrollPrev:function(){return m.index.add(-1).get()!==I()},containerNode:function(){return b},internalEngine:function(){return m},destroy:function(){_||(_=!0,a.clear(),T(),l.emit("destroy"),l.clear())},off:h,on:p,emit:f,plugins:function(){return y},previousScrollSnap:function(){return m.indexPrevious.get()},reInit:g,rootNode:function(){return e},scrollNext:function(e){R(m.index.add(1).get(),e,-1)},scrollPrev:function(e){R(m.index.add(-1).get(),e,1)},scrollProgress:function(){return m.scrollProgress.get(m.location.get())},scrollSnapList:function(){return m.scrollSnapList},scrollTo:R,selectedScrollSnap:I,slideNodes:function(){return x},slidesInView:function(){return m.slidesInView.get()},slidesNotInView:function(){return m.slidesInView.get(!1)}};return N(t,n),setTimeout((()=>l.emit("init")),0),C}Lo.globalOptions=void 0;Mr(".embla {\n  width: 100%;\n  margin: auto;\n  --slide-height: 19rem;\n  --slide-spacing: 1rem;\n  --slide-size: 100%;\n  position: relative;\n}\n.embla__container {\n  display: flex;\n  touch-action: pan-y pinch-zoom;\n  margin-right: 20px;\n}\n.embla__slide {\n  transform: translate3d(0, 0, 0);\n  flex: 0 0 var(--slide-size);\n  min-width: 0;\n  padding-left: var(--slide-spacing);\n}\n.embla__slide__number {\n  box-shadow: inset 0 0 0 0.2rem var(--detail-medium-contrast);\n  border-radius: 1.8rem;\n  font-size: 4rem;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: var(--slide-height);\n  user-select: none;\n}\n\n.custom-button {\n  border: none;\n  border-radius: 50%;\n  cursor: pointer;\n  transition: background-color 0.3s ease;\n  height: 32px;\n  width: 32px;\n  z-index: 15;\n  pointer-events: auto;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.custom-button:hover {\n  pointer-events: auto;\n}\n\n.prev-btn {\n  position: absolute;\n  left: -38px;\n  top: 50%;\n}\n\n.next-btn {\n  position: absolute;\n  right: -12px;\n  top: 50%;\n}\n\n.carousel-arrows {\n  height: 12px;\n  width: 16px;\n}\n");const zo=e=>{const{assets:t,theme:n={},children:r,noOfCards:i=0}=e,[o,s]=vr(!1),[a,l]=vr(!1),[c,u]=vr(!1),[d,p]=vr(0),h=Sr(null),f=Sr(null),g={inactive:{backgroundColor:n.primaryColor,opacity:.5},active:{backgroundColor:n.primaryColor}},m=e=>{e.altKey&&c&&(e.key===kt?(e.preventDefault(),b()):e.key===vt&&(e.preventDefault(),y()))};wr((()=>{const e=h.current,t=new IntersectionObserver((([e])=>{u(e.isIntersecting)}),{threshold:.75}),n=new ResizeObserver((()=>{e&&p(e.clientWidth)}));return e&&(n.observe(e),t.observe(e)),()=>{e&&(t.unobserve(e),n.unobserve(e)),t.disconnect(),n.disconnect()}}),[]),wr((()=>(c?document.addEventListener("keyup",m):document.removeEventListener("keyup",m),()=>{document.removeEventListener("keyup",m)})),[c]),wr((()=>{if(h.current){const e=Lo(h.current,{loop:!1});f.current=e;const t=()=>{s(e.canScrollNext()),l(e.canScrollPrev())};e.on("select",t),t()}return()=>{f.current?.destroy()}}),[d]),wr((()=>{f.current&&i>2&&(s(f?.current?.canScrollNext()),l(f?.current?.canScrollPrev()))}),[i]);const y=()=>{f.current?.scrollNext()},b=()=>{f.current?.scrollPrev()},_=Nr((()=>(o||a)&&U(x,{children:[U("button",{className:"prev-btn custom-button",style:a?g.active:g.inactive,onClick:b,disabled:!a,children:U("img",{src:t?.leftArrow,alt:"Previous",className:"carousel-arrows"})}),U("button",{className:"next-btn custom-button",style:o?g.active:g.inactive,onClick:y,disabled:!o,children:U("img",{src:t?.rightArrow,alt:"Next",className:"carousel-arrows"})})]})),[o,a,t,g]);return U("div",{className:"embla",children:U("div",{className:"embla__viewport",ref:h,children:[U("div",{className:"embla__container",children:r}),_]})})};Mr(".button-chip-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.disabled-button {\n  pointer-events: none;\n  opacity: 0.5;\n}\n");const Po=e=>{const{customStyle:t={},hoveredStyle:n={},text:r,disabled:i,handleClick:o,className:s}=e,[a,l]=vr(t);return U("div",{className:`button-chip-container ${i&&"disabled-button"} ${s&&s}`,style:a,onMouseEnter:()=>l(n),onMouseLeave:()=>l(t),onClick:o,"data-testid":`${r}-button`,children:r})},$o=e=>{const{image:t,alt:n,customClass:r,settings:i}=e,[o,s]=vr(Xn(t)?t:i?.assets?.imagePlaceholder);wr((()=>{s(Xn(t)?t:i?.assets?.imagePlaceholder)}),[t]);return U("img",{src:o,className:r,alt:n,onError:({currentTarget:e})=>(e.onerror=null,void s(i?.assets?.brokenImagePlaceholder))})};Mr(".dynamic-card-container {\n  width: 210px;\n  height: 100%;\n  border: 1px solid #d2d2d2;\n  border-radius: 12px;\n  box-shadow: 0px 1px 2px 0px #1018280f;\n  padding: 10px;\n  line-height: 16px;\n  font-size: 12px;\n  display: flex;\n  position: relative;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.dynamic-number-badge {\n  position: absolute;\n  display: flex;\n  top: -8px;\n  left: -8px;\n  justify-content: center;\n  align-items: center;\n  min-width: 20px;\n  height: 20px;\n  border-radius: 10px;\n  font-size: 12px;\n  font-weight: 500;\n  margin-right: 4px;\n}\n\n.dynamic-cover-image-container {\n  height: 90px;\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.dynamic-cover-image {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.dynamic-card-main-content {\n  display: flex;\n  flex-direction: column;\n}\n\n.dynamic-chip {\n  font-size: 12px;\n  font-weight: 600;\n  padding: 4px 10px;\n  border-radius: 20px;\n  margin-right: 4px;\n  min-width: 56px;\n  text-align: center;\n  white-space: nowrap;\n  margin-top: 2px;\n}\n\n.dynamic-card-content {\n  display: flex;\n  flex-direction: column;\n}\n\n.dynamic-title {\n  font-size: 12px;\n  font-weight: 600;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  line-height: 16px;\n}\n\n.dynamic-header {\n  font-size: 12px;\n  font-weight: 600;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  line-height: 16px;\n}\n\n.dynamic-title-section {\n  display: flex;\n  align-items: center;\n  flex-direction: row;\n}\n\n.dynamic-bold {\n  font-weight: 600;\n}\n\n.dynamic-highlight-card {\n  display: flex;\n  flex-direction: column;\n  padding: 8px;\n  border-radius: 8px;\n}\n\n.dynamic-section-heading {\n  font-size: 12px;\n  font-weight: 600;\n}\n\n.dynamic-highlight-title {\n  font-size: 12px;\n  font-weight: 700;\n}\n\n.dynamic-highlight-description {\n  font-size: 12px;\n}\n\n.dynamic-image-card-content {\n  display: flex;\n  flex-direction: row;\n}\n\n.dynamic-image-title {\n  font-size: 12px;\n  font-weight: 600;\n}\n\n.dynamic-image-wrapper {\n  height: auto;\n  max-height: 62px;\n  width: auto;\n  max-width: 70px;\n  min-height: 60px;\n  border-radius: 8px;\n  overflow: hidden;\n  margin-right: 6px;\n}\n\n.dynamic-image {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.dynamic-image-description {\n  font-size: 12px;\n}\n\n.dynamic-icon {\n  width: 16px;\n  height: 16px;\n  margin-right: 4px;\n}\n\n.dynamic-icon-label-row {\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n}\n\n.dynamic-label {\n  font-size: 12px;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.dynamic-description p {\n  font-size: 12px !important;\n  line-height: 16px !important;\n}\n\n.dynamic-main-button {\n  display: flex;\n  width: 100%;\n  min-height: 32px;\n  text-align: center;\n  justify-content: center;\n  align-items: center;\n  border: 1px solid;\n  border-radius: 2000px;\n  font-size: 13px;\n  font-weight: 500;\n  line-height: 16px;\n  cursor: pointer;\n}\n\n.dynamic-card-container .show-more-text {\n  margin-right: 4px;\n}\n\n.dynamic-card-container .show-more-icon {\n  display: inline-block;\n  width: 6px;\n  height: 6px;\n  border: solid #3d5a75;\n  border-width: 0 2px 2px 0;\n  transform: rotate(45deg);\n  margin-top: -2px;\n  transition: transform 0.3s ease;\n}\n\n.dynamic-card-container .show-less-icon {\n  display: inline-block;\n  width: 6px;\n  height: 6px;\n  border: solid #3d5a75;\n  border-width: 0 2px 2px 0;\n  transform: rotate(-135deg);\n  margin-top: 4px;\n  transition: transform 0.3s ease;\n}\n\n.dynamic-card-more-content {\n  max-height: 0;\n  overflow: hidden;\n  transition:\n    max-height 0.5s ease-out,\n    opacity 0.3s ease-out;\n}\n\n.dynamic-card-more-content.open {\n  max-height: 2000px;\n  transition:\n    max-height 0.5s ease-in,\n    opacity 0.3s ease-in;\n}\n\n.dynamic-card-footer {\n  margin-top: auto;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.dynamic-card-header {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.dynamic-card-list {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n");const Bo=e=>{const{cardData:t={},settings:n,isDisabled:r,totalCards:i,cardNumber:o}=e,s=n?.theme||Ye,{headerSection:a,mainContent:l,moreContent:c,footerSection:u,layout:d,options:p}=t||{},{showCardNumber:h,isMoreContent:f}=p||{},{list:g}=a||{},{list:m}=u||{},{list:y}=l||{},{list:b}=c||{},_={container:{backgroundColor:s.cardColor,border:`1px solid ${s.cardColor}`,color:s.textColor,...d},numberBadge:{backgroundColor:s?.badgeColor||ye,color:we},imageContainer:{backgroundColor:Se},highlightCard:{backgroundColor:s.chatWindowColor},primaryButton:{color:we,transition:"background-color 0.3s ease"},primaryButtonHover:{backgroundColor:we,transition:"background-color 0.3s ease"},description:{marginBottom:"4px"},chip:{backgroundColor:s.chatWindowColor}},[k,v]=vr(!1),w=(e,t)=>e?.value?U("div",{style:e.style,className:t,children:e?.value}):null,S=(e,t,n)=>e?.length?U("div",{style:n,className:"dynamic-card-list",children:e?.map(t)}):null,N=e=>w(e,"dynamic-header"),E=(e,t)=>U("div",{className:"dynamic-icon-label-row",children:[U("img",{src:e?.icon?.src,alt:e?.key,className:"dynamic-icon"}),U("div",{className:"dynamic-label",children:e?.value})]},t),T=(e,t)=>U("div",{className:"dynamic-bold-text",children:U("div",{children:[U("span",{className:"dynamic-bold",children:e?.key})," ",`: ${e?.value}`]})},t),R=e=>S(e?.items,T,e?.style),I=e=>w(e,"dynamic-section-description"),C=(e,t)=>U("div",{style:_.highlightCard,className:"dynamic-highlight-card",children:[w(e?.title,"dynamic-highlight-title"),w(e?.description,"dynamic-highlight-description")]},t),A=e=>S(e?.items,C,e?.style),O=(e,t)=>U("div",{className:"dynamic-image-card",children:U("div",{className:"dynamic-image-card-content",children:[U("div",{style:_.imageContainer,className:"dynamic-image-wrapper",children:U($o,{alt:e?.image?.alt,customClass:"dynamic-image",image:e?.image?.src,settings:n})}),U("div",{className:"dynamic-image-details",children:[w(e?.title,"dynamic-image-title"),w(e?.description,"dynamic-image-description"),S(e?.iconLabelList,E,e?.style)]})]})},t),M=e=>e?U(Po,{disabled:r,text:e?.value||"",className:"dynamic-main-button",handleClick:()=>((e="")=>{window.open(e)})(e?.action?.src),customStyle:{..._.primaryButton,...e?.style||{}},hoveredStyle:_.primaryButtonHover}):null,D=Nr((()=>o?U("div",{style:_.numberBadge,className:"dynamic-number-badge",children:o}):null),[o]),L=Nr((()=>g?.map((e=>{switch(e?.type){case $t:return N(e);case Bt:return Yn(t=e)?U("div",{style:_.imageContainer,className:"dynamic-cover-image-container",children:U($o,{alt:t?.alt,customClass:"dynamic-cover-image",image:t?.src,settings:n})}):null;default:return null}var t}))),[g]),z=Nr((()=>m?.map((e=>{switch(e?.type){case Ut:return M(e);case Vt:return f?(e=>U("div",{class:"show-more",onClick:()=>v(!k),children:[U("span",{class:"show-more-text",children:k?e?.data?.showLess?.value:e?.data?.showMore?.value}),U("span",k?{class:"show-less-icon"}:{class:"show-more-icon"})]}))(e):null;default:return null}}))),[m,k,r]),P=Nr((()=>U(x,{children:y?.map((e=>{switch(e?.type){case jt:return(i=e)?U("div",{style:i?.style,className:"dynamic-title-section",children:[i?.chip&&(s=i?.chip,U("div",{style:_.chip,className:"dynamic-chip",children:s?.value})),i?.title&&(o=i?.title,w(o,"dynamic-title"))]}):null;case Ht:return r=e,r?.value&&U("div",{style:_.description,className:"dynamic-description",dangerouslySetInnerHTML:{__html:Xi(r?.value)}});case $t:return N(e);case Ft:return I(e);case Gt:return n=e,S(n?.items,E,n?.style);case qt:return A(e);case Wt:return t=e,S(t?.items,O,t?.style);case Jt:return R(e);default:return null}var t,n,r,i,o,s}))})),[y]),$=Nr((()=>U(x,{children:b?.map((e=>{switch(e?.type){case $t:return N(e);case qt:return A(e);case Ft:return I(e);case Jt:return R(e);default:return null}}))})),[b]);return U("div",{className:`dynamic-card-container ${r&&i===o&&"card-container-animation"}`,style:_.container,"data-testId":"dynamic-card",children:[h&&D,Kn(g)&&U("div",{className:"dynamic-card-header",children:L}),Kn(y)&&U("div",{className:"dynamic-card-content",children:P}),Kn(b)&&U("div",{className:`dynamic-card-more-content ${k&&"open"}`,children:$}),Kn(m)&&U("div",{className:"dynamic-card-footer",children:z})]})};Mr(".feedback-chat-container {\n  border: 1px solid #d2d2d2;\n  border-radius: 12px;\n  padding: 10px;\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 65%;\n  margin-left: 38px;\n  margin-top: -1px;\n  margin-bottom: 12px;\n  max-width: 300px;\n}\n\n.feedback-chat-row {\n  display: flex;\n  flex-direction: row;\n  gap: 4px;\n}\n\n.feedback-icon-container {\n  min-width: 32px;\n  min-height: 32px;\n  border-radius: 50%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n}\n\n.feedback-icon {\n  min-width: 16px;\n  min-height: 16px;\n  width: 16px;\n  height: 16px;\n}\n\n.feedback-message {\n  font-weight: 500;\n  font-size: 13px;\n  line-height: 16px;\n}\n\n.feedback-disabled {\n  pointer-events: none;\n  cursor: not-allowed;\n  opacity: 0.9;\n}\n");const Uo=e=>{const{feedbackData:t,settings:n,onFeedbackSubmit:r=async()=>null}=e,{thumbsDownActive:i,thumbsDown:o,thumbsUpActive:s,thumbsUp:a}=n?.assets||{},[l,c]=vr(t?.feedback||null),[u,d]=vr(!1),p={container:{backgroundColor:n?.theme?.chatBubbleColor},active:{backgroundColor:n?.theme?.primaryColor},inactive:{backgroundColor:we},text:{color:n?.theme?.textColor}};wr((()=>{er(t?.feedback)&&c(t?.feedback||null)}),[t?.feedback]);const h=async e=>{if(u)return;d(!0);const t=l,n=e===t?0:e;c(n);const i=await r(n);er(i)?c(i):c(t),d(!1)};return U("div",{className:"feedback-chat-container",style:p.container,children:[U("div",{style:p.text,className:"feedback-message",children:Ue}),U("div",{className:"feedback-chat-row",children:[U("div",{style:1===l?p.active:p.inactive,onClick:()=>{h(1===l?0:1)},className:`feedback-chat-thumbsUp feedback-icon-container ${u&&"feedback-disabled"}`,children:U("img",{src:1===l?s:a,alt:"thumbsUp icon",className:"feedback-icon"})}),U("div",{style:-1===l?p.active:p.inactive,onClick:()=>{h(-1===l?0:-1)},className:`feedback-chat-thumbsDown feedback-icon-container ${u&&"feedback-disabled"}`,children:U("img",{src:-1===l?i:o,alt:"thumbsDown icon",className:"feedback-icon"})})]})]})};Mr(".feedback-message-container {\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  flex-direction: row;\n  font-size: 12px;\n}\n\n.feedback-message-thumbsUp {\n  width: 24px;\n  height: 24px;\n  margin-right: 5px;\n  margin-left: 6px;\n  border-radius: 12px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n  box-shadow: 0px 2px 3px rgba(0, 0, 0, 0.1);\n}\n\n.feedback-message-thumbsDown {\n  width: 24px;\n  height: 24px;\n  border-radius: 12px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n  box-shadow: 0px 2px 3px rgba(0, 0, 0, 0.1);\n}\n\n.feedback-message-row {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: row;\n}\n\n.feedback-disabled {\n  pointer-events: none;\n  cursor: not-allowed;\n  opacity: 0.9;\n}\n");const Ho=e=>{const{feedbackData:t,settings:n,isDisabled:r,onFeedbackSubmit:i=async()=>null}=e,{thumbsDownActive:o,thumbsDown:s,thumbsUpActive:a,thumbsUp:l}=n?.assets||{},[c,u]=vr(t?.feedback||null),[d,p]=vr(!1),h={active:{backgroundColor:n?.theme?.primaryColor},inactive:{backgroundColor:we},text:{color:Ne}};wr((()=>{er(t?.feedback)&&u(t?.feedback||null)}),[t?.feedback]);const f=async e=>{if(d)return;p(!0);const t=c,n=e===t?0:e;u(n);const r=await i(n);er(r)?u(r):u(t),p(!1)};return U("div",{className:`feedback-message-container ${r&&"no-click"}`,children:[U("div",{style:h.text,children:Be}),U("div",{className:"feedback-message-row",children:[U("div",{style:1===c?h.active:h.inactive,onClick:()=>f(1),className:`feedback-message-thumbsUp ${d&&"feedback-disabled"}`,children:U("img",{src:1===c?a:l,alt:"thumbsUp icon",width:14,height:14})}),U("div",{style:-1===c?h.active:h.inactive,onClick:()=>f(-1),className:`feedback-message-thumbsDown ${d&&"feedback-disabled"}`,children:U("img",{src:-1===c?o:s,alt:"thumbsDown icon",width:14,height:14})})]})]})};Mr(".retry {\n  display: flex;\n  flex-direction: row;\n  font-size: 12px;\n  font-weight: 400;\n  align-items: center;\n}\n\n.retry-label {\n  opacity: 60%;\n}\n\n.retry-error-icon {\n  height: 12px;\n  width: 13.68px;\n  margin-right: 8px;\n}\n\n.retry-cta {\n  cursor: pointer;\n  margin-left: 4px;\n  display: flex;\n  flex-direction: row;\n  gap: 2px;\n  align-items: center;\n}\n\n.retry-icon {\n  width: 12px;\n  height: 12px;\n}\n\n.cta-label {\n  text-decoration: underline;\n  opacity: 1;\n}\n");const Fo=e=>{const{settings:t,label:n,ctaIcon:r,ctaLabel:i,ctaFunction:o,customClass:s}=e,a={ctaLabel:{color:t?.theme?.primaryColor}};return U("div",{className:`${s} retry`,"data-testid":"retry-component",children:[U("img",{src:t?.assets?.errorIcon,alt:"error",className:"retry-error-icon"}),U("div",{className:"retry-label",children:n}),U("div",{onClick:()=>{o&&(qn.info(ht),o())},className:"retry-cta",children:[U("img",{src:r,alt:"retry",className:"retry-icon"}),U("div",{className:"cta-label",style:a.ctaLabel,children:i})]})]})};Mr("@keyframes blink {\n  0% {\n    opacity: 0.12;\n    transform: scale(1);\n  }\n  21.43% {\n    opacity: 0.38;\n    transform: scale(1.2);\n  }\n  42.86% {\n    opacity: 0.12;\n    transform: scale(1);\n  }\n  100% {\n    opacity: 0.12;\n    transform: scale(1);\n  }\n}\n\n.dot-container {\n  align-items: center;\n  border-radius: 0px 10px 10px 10px;\n  display: flex;\n  gap: 6px;\n  justify-content: center;\n  padding: 16px 12px;\n  width: 50px;\n}\n\n.dot {\n  animation: blink 1.4s infinite;\n  animation-fill-mode: both;\n  border-radius: 50%;\n  height: 6px;\n  width: 6px;\n}\n\n.dot:nth-child(1) {\n  animation-delay: 0.4s;\n}\n\n.dot:nth-child(2) {\n  animation-delay: 0.6s;\n}\n\n.dot:nth-child(3) {\n  animation-delay: 0.8s;\n}\n");const jo=e=>{const{theme:t}=e;return U("div",{className:"dot-container",style:{backgroundColor:t.chatBubbleColor},"data-testId":"typing-bubble",children:Array.from({length:3},((e,n)=>U("span",{className:"dot",style:{backgroundColor:t?.textColor}},n)))})};function Go(e,t){const n=[];for(let r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}Mr(".chat-bot-message-container {\n  width: calc(100% -40px);\n  align-items: flex-start;\n}\n\n.chat-row {\n  display: flex;\n  flex-direction: row;\n  align-items: start;\n}\n\n.message-and-welcome-suggestion {\n  display: flex;\n  flex-direction: column;\n  max-width: 75%;\n  gap: 12px;\n}\n\n.chat-message {\n  padding: 10px;\n  border-radius: 10px;\n  overflow: hidden;\n  position: relative;\n  word-wrap: break-word;\n  overflow-wrap: break-word;\n  width: fit-content;\n}\n\n.bot-message {\n  padding: 12px;\n  position: relative;\n  border-top-left-radius: 0;\n  width: fit-content;\n}\n\n.chat-timestamp {\n  font-size: 11px;\n  margin-top: 5px;\n}\n\n.bot-retry {\n  font-size: 12px;\n  margin-top: 3px;\n  margin-left: 40px;\n  margin-bottom: 12px;\n}\n\n.chat-bot-timestamp {\n  font-size: 12px;\n  margin-top: 3px;\n  margin-left: 40px;\n  opacity: 60%;\n  margin-bottom: 12px;\n}\n\n.bot-avatar {\n  width: 32px;\n  height: 32px;\n  margin-right: 6px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 50%;\n  overflow: hidden;\n}\n\n.bot-avatar img {\n  width: 20px;\n  height: 20px;\n  font-size: 6px;\n}\n\n.listing-card-container {\n  margin-right: 10px;\n}\n\n.matrix-card-container {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  margin-right: 8px;\n}\n\n.json-message-container {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: calc(100% - 50px);\n}\n\n.no-gap {\n  gap: 0px !important;\n}\n\n@media only screen and (max-width: 600px) {\n  .message-and-welcome-suggestion {\n    max-width: 75%;\n  }\n}\n\n/* Add the following styles for overwrite markdown styles from chatbot */\n.bot-message h1 {\n  font-size: 18px;\n  line-height: 23px;\n  font-weight: 700;\n  padding: 0px;\n  margin: 0px;\n}\n\n.bot-message h2 {\n  font-size: 17px;\n  line-height: 22px;\n  font-weight: 600;\n  padding: 0px;\n  margin: 0px;\n}\n\n.bot-message h3 {\n  font-size: 16px;\n  line-height: 21px;\n  font-weight: 600;\n  padding: 0px;\n  margin: 0px;\n}\n\n.bot-message img {\n  max-width: 80%;\n  resize: contain;\n}\n\n.bot-message p {\n  font-size: 15px;\n  line-height: 21px;\n  font-weight: 400;\n  padding: 0px;\n  margin: 0;\n}\n\n.bot-message table {\n  border-collapse: collapse;\n  border: 1px solid black;\n  margin: 6px;\n}\n\n.bot-message table td,\nth {\n  border: 1px solid black;\n  padding: 8px;\n}\n\n.bot-message ol {\n  font-size: 15px;\n  line-height: 21px;\n  font-weight: 400;\n  padding: 0px;\n  padding-left: 16px;\n  padding-bottom: 3px;\n  margin: 0px;\n}\n.bot-message ul {\n  font-size: 15px;\n  line-height: 21px;\n  font-weight: 400;\n  padding: 0px;\n  padding-left: 16px;\n  padding-bottom: 3px;\n  margin: 0px;\n}\n\n.bot-message li {\n  font-size: 15px;\n  line-height: 21px;\n  font-weight: 400;\n  padding: 0px;\n  padding-left: 4px;\n  padding-bottom: 3px;\n  margin: 0px;\n}\n\n.bot-message a {\n  color: #0076ce;\n  font-weight: 600;\n  text-decoration: none;\n  border-bottom: none;\n}\n\n.bot-message a:hover {\n  color: #0076ce;\n}\n\n.message-feedback-container {\n  width: 80%;\n}\n\n.bot-typing-bubble {\n  margin-top: -6px;\n}\n");const Jo=e=>{const{message:t,index:n,theme:r,assets:i,settings:o,jsonMessageData:s,onClickActionChip:a,isStreaming:l,setSuggestions:c,showSuggestions:u=!1,backendBaseUrl:d,updateMessages:p,handleRetry:h}=e,{errorCode:f,prefixText:g,isMultiple:m=!1,bookings:y,postfixText:b,message:x}=s,_=jn(s),{layoutType:k,data:v,summary:w}=_||{},S=!v,N={bubble:{backgroundColor:r.chatBubbleColor,color:r.textColor,maxHeight:"fit-content"},showMoreButton:{color:r.primaryColor},botAvatarBg:{backgroundColor:r.primaryColor}},[E,T]=vr(Gn({key:nn.LATEST_RATED_MESSAGE})||"");if(wr((()=>(window.addEventListener("storage",R),()=>{window.removeEventListener("storage",R)})),[]),wr((()=>{s?.suggestions&&c&&c(s?.suggestions)}),[s]),!t)return null;const R=e=>{e.key===nn.LATEST_RATED_MESSAGE&&T(Gn({key:nn.LATEST_RATED_MESSAGE})||"")},I=async e=>{try{const n=await sr(`${Xn(d)?d:"https://keyvalue-core-svc.milestonedev.info"}/${Nt}/feedback`,We.POST,{feedback:e,runId:t?.messageId}),r={messageId:t?.messageId||"",feedback:n?.feedback};return er(n?.feedback)&&(e=>{const t=Gn({key:nn.MESSAGES}),n=JSON.parse(t||"[]").map((t=>t?.aiMessage?.messageId!==e.messageId?t:(Jn({key:nn.LATEST_RATED_MESSAGE,value:JSON.stringify({messageId:t?.aiMessage?.messageId,feedback:e.feedback})}),{...t,aiMessage:{...t.aiMessage,feedback:e.feedback}})));Jn({key:nn.MESSAGES,value:JSON.stringify(n)})})(r),p&&p(r),n?.feedback}catch(e){return qn.error(JSON.stringify({...Ve[Ze.GENERIC_API_ERROR],error:e})),null}},C=e=>(!0===o?.chatLinkConfig?.openInNewTab&&(e=Xi(e).replace(/<a /g,'<a target="_blank" ')),U("div",{className:`${t?.failed&&"failed-message"} message-and-welcome-suggestion ${l&&"no-click"}`,children:[U("div",{className:"chat-message bot-message",style:N.bubble,children:U("div",{id:`marked-text-container-${n}`,dangerouslySetInnerHTML:{__html:Xi(e)}})}),t?.type===gt&&a&&u&&U(Lr,{settings:o,onClickActionChip:a,chipsItemsList:o?.actionPromptsList}),t?.messageStructure===rn.MARKDOWN&&L&&U(Ho,{settings:o,feedbackData:{feedback:t?.feedback},onFeedbackSubmit:I,isDisabled:l})]})),A=Nr((()=>v?.length>0?U(zo,{theme:r,assets:i,settings:o,noOfCards:v?.length,children:v?.map(((e,t)=>U("div",{className:"listing-card-container embla_slide",children:U(Bo,{settings:o,isDisabled:l,cardData:e,totalCards:v?.length,cardNumber:t+1})})))}):null),[v,l,o]),O=Nr((()=>v?U(Bo,{settings:o,isDisabled:l,cardData:v}):null),[v,l,o]),M=Nr((()=>v?.length>0?U(zo,{theme:r,assets:i,settings:o,noOfCards:v?.length,children:Go(v,5).map(((e,t)=>U("div",{className:"matrix-card-container",children:e?.map((r=>U(Bo,{settings:o,cardData:r,isDisabled:l,totalCards:e?.length,cardNumber:5*t+(n+1)})))})))}):null),[v,l,o]),D=()=>{switch(k){case Zt:return A;case Kt:return O;case Yt:return M;default:return null}},L=Nr((()=>!(!t?.shouldShowFeedback||!Yn(s))&&Object.keys(s).every((e=>!At.includes(e)))),[t?.shouldShowFeedback,s]),z=Nr((()=>{try{if(Yn(s)){const e=JSON.parse(E||"{}");let n=t?.feedback;return e?.messageId===t?.messageId&&(n=e?.feedback),Object.keys(s).map((e=>At.includes(e)?U(Uo,{feedbackData:{feedback:n},settings:o,onFeedbackSubmit:I}):null))}}catch{return null}}),[E,s,t?.feedback,t?.shouldShowFeedback]);return U("div",{className:"chat-bot-message-container","data-testId":"chat-bot-message-bubble",children:[U("div",{className:"chat-row",children:[U("div",{style:N.botAvatarBg,className:"bot-avatar",children:U("img",{src:i?.logo,alt:"bot icon"})}),t?.messageStructure===rn.MARKDOWN?C(t.text):(()=>{try{return U("div",{className:`${t?.failed&&"failed-message"} json-message-container ${(f||S)&&"no-gap"}`,children:[g&&C(g),w&&U(Bo,{cardData:w,settings:o,isDisabled:!1}),D(),Kn(y)&&!m&&U(Bo,{cardData:v?.[0],settings:o,isDisabled:l}),Kn(y)&&m&&U(Bo,{cardData:v?.[0],settings:o,isDisabled:l}),U("div",{className:"message-feedback-container",children:L&&U(Ho,{settings:o,feedbackData:{feedback:t?.feedback},onFeedbackSubmit:I,isDisabled:l})}),b&&C(b),f&&C(x),S&&(l?U("div",{className:"bot-typing-bubble",children:U(jo,{theme:o?.theme||Ye})}):C(Ve[Ze.ERROR_IN_PARSING]?.message))]})}catch{return qn.error(JSON.stringify({...Ve[Ze.ERROR_IN_PARSING],info:{fileName:"botMessage.tsx",functionName:"renderJsonMessage"}})),C(Ve[Ze.ERROR_IN_PARSING]?.message)}})()]}),t?.failed?U(Fo,{settings:o,label:Je,ctaFunction:h,ctaLabel:Fe,customClass:"bot-retry",ctaIcon:o?.assets?.regenerateIcon}):U("div",{className:"chat-bot-timestamp",children:tn(t?.timestamp,"h:MM TT")}),!l&&t?.shouldShowFeedback&&z]},n)};Mr(".chat-user-message-container {\n  width: calc(100% - 40px);\n  align-items: flex-end;\n  margin-left: 40px;\n}\n\n.user-chat-row {\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n}\n\n.chat-user-message {\n  padding: 10px;\n  border-radius: 10px;\n  border-top-right-radius: 0;\n  max-width: 70%;\n  overflow: hidden;\n  position: relative;\n  word-wrap: break-word;\n  overflow-wrap: break-word;\n}\n\n.user-message {\n  border-top-right-radius: 0;\n}\n\n.chat-user-timestamp {\n  font-size: 12px;\n  margin-top: 3px;\n  opacity: 60%;\n  margin-bottom: 12px;\n  margin-right: 42px;\n  text-align: end;\n}\n\n.failed-message {\n  opacity: 0.5;\n}\n\n.user-retry {\n  font-size: 12px;\n  margin-top: 3px;\n  margin-bottom: 12px;\n  margin-right: 42px;\n  justify-content: end;\n}\n\n.user-avatar {\n  width: 32px;\n  height: 32px;\n  margin-left: 5px;\n  border-radius: 50%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  overflow: hidden;\n}\n\n.user-avatar img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  font-size: 6px;\n}\n.chat-date {\n  width: 100%;\n  text-align: center;\n  font-size: 12px;\n  opacity: 60%;\n  margin-bottom: 15px;\n}\n");const Wo=e=>{const{message:t,index:n,theme:r,assets:i,settings:o,onClickActionChip:s,isExpanded:a,isStreaming:l,setSuggestions:c,showSuggestions:u,updateMessages:d,handleRetry:p}=e,[h,f]=vr({}),g=t?.userMessage,m=t?.aiMessage,y=t?.dateMessage,b={bubble:{backgroundColor:r.primaryColor,color:we,maxHeight:"fit-content"},bubbleBot:{backgroundColor:r.chatBubbleColor,color:r.textColor,maxHeight:"fit-content"},showMoreButton:{color:r.primaryColor},botAvatarBg:{backgroundColor:r.primaryColor},avatarImage:{backgroundColor:r.primaryColor},botIcon:{backgroundColor:o?.theme?.primaryColor},dateMessage:{color:r.textColor}};wr((()=>{try{if(m?.messageStructure===rn.JSON_TOKEN){const e=Hr.parse(m?.text,Hr.STR|Hr.OBJ|Hr.ARR|Hr.NUM|Hr.BOOL);f(e)}else if(m?.messageStructure===rn.JSON)if(Xn(m?.text)){const e=Hr.parse(m?.text,Hr.STR|Hr.OBJ|Hr.ARR|Hr.NUM|Hr.BOOL);f(e)}else f(m?.text)}catch{qn.warn(Ve[Ze.ERROR_IN_PARSING]?.message)}}),[t]);const _=()=>{p&&t&&p(t)};return U(x,{children:[y&&U("div",{className:"chat-date",style:b.dateMessage,"data-testId":"message-date",children:y?.text},n),g&&U("div",{className:"chat-user-message-container","data-testId":"chat-user-message-bubble",children:[U("div",{className:`${g?.failed&&"failed-message"} user-chat-row`,children:[U("div",{className:"chat-user-message",style:b.bubble,children:g?.text}),U("div",{style:b.avatarImage,className:"user-avatar",children:U("img",{src:i?.avatar,alt:"user avatar"})})]}),g?.failed?U(Fo,{settings:o,label:t?.userMessage?.isMessageSendClientError?je:Ge,ctaFunction:_,ctaLabel:He,customClass:"user-retry",ctaIcon:o?.assets?.retryIcon}):U("div",{className:"chat-user-timestamp",children:tn(g?.timestamp,"h:MM TT")})]},n),m&&Nr((()=>m?U(Jo,{isExpanded:a,message:m,index:n,theme:r,assets:i,settings:o,jsonMessageData:h,isStreaming:l,onClickActionChip:s,setSuggestions:c,showSuggestions:u,updateMessages:d,handleRetry:_}):null),[m,h,u,a]),!m?.text&&l?U("div",{className:"typing-row",children:[U("div",{style:b.botIcon,className:"bot-avatar",children:U("img",{src:o?.assets?.logo,alt:"bot icon",width:30,height:30})}),U(jo,{theme:o?.theme||Ye})]}):null]})};Mr(".popup-container {\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  padding: 8px 12px;\n}\n\n.popup {\n  position: absolute;\n  bottom: 80px;\n  right: 10px;\n  width: 150px;\n  background-color: #fff;\n  color: #000;\n  border-radius: 8px;\n  padding: 10px 15px;\n  max-width: 200px;\n  font-size: 14px;\n  z-index: 10;\n}\n\n.popup::after {\n  content: '';\n  position: absolute;\n  bottom: -10px;\n  right: 20px;\n  width: 0;\n  height: 0;\n  border-left: 10px solid transparent;\n  border-right: 10px solid transparent;\n  border-top: 10px solid #fff;\n}\n\n.tooltip-close-button {\n  position: absolute;\n  top: -10px;\n  right: -10px;\n  width: 24px;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  border: none;\n  z-index: 1000;\n}\n\n.tooltip-close-icon {\n  cursor: pointer;\n}\n");const qo=e=>{const{streaming:t,chatContainerRef:n,settings:r,handleChatContainerScroll:i,handleSendMessage:o,isApiMessagesLoading:s,messages:a=[],previousMessages:l=[],currentMessageData:c,currentEvent:u,isExpanded:d,setSuggestions:p,updateMessages:h,handleRetry:f}=e,g={display:{backgroundColor:r?.theme?.chatWindowColor,color:r?.theme?.textColor}},m=e=>{o(e.messagePrompt)},y=e=>Xn(e?.aiMessage?.text)||Xn(e?.userMessage?.text),b=Nr((()=>{if(0==a?.filter(y).length&&0==l?.length&&!c?.aiMessage?.text&&!t&&!s)return U("div",{className:"start-conversation",children:Oe});const e=Vn([...l,...a]);return e?.map(((n,i)=>U(Wo,{isExpanded:d,message:n,index:i,theme:r?.theme||Ye,event:u,assets:r?.assets,settings:r,isShowMoreVisible:i!==e.length-1,onClickActionChip:m,updateMessages:h,...i===e.length-1&&{setSuggestions:p},showSuggestions:!(1!==i||i!==e.length-1||t),handleRetry:f})))}),[a,c,t,l,d]),_=Nr((()=>U(x,{children:U(Wo,{message:c,index:-1,theme:r?.theme||Ye,assets:r?.assets,settings:r,isStreaming:t,setSuggestions:p,isExpanded:d,updateMessages:h,handleRetry:f})})),[t,c,d]);return U("div",{className:"chat-display",ref:n,style:g.display,onScroll:i,children:[s&&U("div",{className:"loading-older-messages",children:De}),b,_]})};Mr(".popup-container {\n  position: fixed;\n  bottom: 40px;\n  right: 20px;\n  padding: 8px 12px;\n  z-index: 1000;\n}\n\n.popup {\n  position: absolute;\n  bottom: 80px;\n  right: 10px;\n  width: 172px;\n  background-color: #fff;\n  color: #000;\n  border-radius: 8px;\n  padding: 10px 15px;\n  max-width: 200px;\n  font-size: 14px;\n  z-index: 10;\n}\n\n.popup::after {\n  content: '';\n  position: absolute;\n  bottom: -10px;\n  right: 20px;\n  width: 0;\n  height: 0;\n  border-left: 10px solid transparent;\n  border-right: 10px solid transparent;\n  border-top: 10px solid #fff;\n}\n\n.tooltip-close-button {\n  position: absolute;\n  top: -10px;\n  right: -10px;\n  width: 24px;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  border: none;\n  z-index: 1000;\n}\n\n.tooltip-close-icon {\n  cursor: pointer;\n  height: 20px;\n  width: 20px;\n}\n");const Vo=e=>{const{settings:t,toggleChatWindow:n}=e,r=t?.assets?.botIcon||"",i=t?.assets?.botIconHover||"",[o,s]=vr(!0),[a,l]=vr(r),c={button:{bottom:t?.position?.bottom,right:t?.position?.right,backgroundColor:Xn(a)?"transparent":t?.theme?.primaryColor}};return U(x,{children:[o&&U("div",{className:"popup-container",children:U("div",{className:"popup",children:[Me,U("div",{className:"tooltip-close-button",onClick:()=>s(!1),children:U("img",{src:t?.assets?.closeIconTooltip,alt:"Close",className:"tooltip-close-icon"})})]})}),U("div",{className:"chatbot-button","data-testid":"chatbot-icon",style:c.button,onClick:n,children:U("img",{onMouseEnter:()=>l(i),onMouseLeave:()=>l(r),src:a,alt:"Chat",className:"chat-circle-icon"})})]})};Mr(".reset-popup-container {\n  border: none;\n  border-radius: 12px;\n  padding: 16px;\n  background-color: white;\n  width: 300px;\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.reset-header {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n}\n\n.reset-title {\n  font-weight: 500;\n  font-size: 16px;\n}\n\n.reset-close {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n}\n\n.reset-close-icon {\n  height: 12px;\n  width: 12px;\n}\n\n.reset-confirmation {\n  font-weight: 400;\n  font-size: 12px;\n  line-height: 18px;\n}\n\n.reset-options {\n  display: flex;\n  flex-direction: row;\n  padding-top: 12px;\n  gap: 12px;\n}\n\n.reset-option-buttons {\n  height: 32px;\n  border: 1px;\n  cursor: pointer;\n  width: 100%;\n}\n");const Zo=e=>{const{theme:t,handleReset:n,handleCancel:r,closeIcon:i=""}=e,o={container:{backgroundColor:t.chatWindowColor,color:t.textColor},filled:{backgroundColor:t.primaryColor,color:we,borderRadius:"2000px",padding:"4px 16px",transition:"background-color 0.3s ease"},unfilled:{border:"solid 1px",backgroundColor:we,color:t.primaryColor,borderRadius:"2000px",padding:"4px 16px",transition:"background-color 0.3s ease"}},s=Nr((()=>i?.length?U("img",{src:i,alt:"close",className:"reset-close-icon"}):"X"),[i]);return U("div",{style:o.container,className:"reset-popup-container",children:[U("div",{className:"reset-header",children:[U("div",{className:"reset-title",children:Le}),U("div",{onClick:r,className:"reset-close",children:s})]}),U("div",{className:"reset-confirmation",children:ze}),U("div",{className:"reset-options",children:[U("div",{className:"reset-option-buttons",children:U(Po,{customStyle:o.filled,hoveredStyle:o.unfilled,text:Pe,handleClick:n})}),U("div",{className:"reset-option-buttons",children:U(Po,{customStyle:o.unfilled,hoveredStyle:o.filled,text:$e,handleClick:r})})]})]})};Mr(".chat-header {\n  padding: 15px;\n  font-size: 18px;\n  font-weight: 600;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border-top-left-radius: 15px;\n  border-top-right-radius: 15px;\n}\n\n.header-row {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n\n.title {\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.close-icon {\n  cursor: pointer;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 16px;\n  height: 16px;\n}\n\n.resize-icon {\n  cursor: pointer;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 16px;\n  height: 16px;\n  margin-right: 14px;\n}\n\n.reset-icon-container {\n  cursor: pointer;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 16px;\n  height: 16px;\n  margin-right: 13px;\n}\n\n.reset-icon {\n  cursor: pointer;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 16px;\n  height: 16px;\n}\n\n.header-image {\n  margin-right: 8px;\n}\n\n.chat-header .tooltip-container {\n  position: relative;\n  display: inline-block;\n  cursor: pointer;\n}\n\n.chat-header .tooltip-container::after {\n  content: attr(data-tooltip);\n  position: absolute;\n  top: 150%;\n  left: 30%;\n  transform: translateX(-50%);\n  background-color: #333;\n  color: #fff;\n  padding: 5px 8px;\n  border-radius: 4px;\n  font-size: 12px;\n  white-space: nowrap;\n  opacity: 0;\n  visibility: hidden;\n  transition:\n    opacity 0.2s ease-in-out,\n    visibility 0.2s ease-in-out;\n  z-index: 1000;\n}\n\n.chat-header .tooltip-container:hover::after {\n  opacity: 1;\n  visibility: visible;\n}\n\n.disabled-reset {\n  opacity: 0.6;\n  cursor: not-allowed !important;\n}\n\n.overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  z-index: 1001;\n}\n\n.reset-modal {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1001;\n  width: 100%;\n  height: 100%;\n}\n\n.linear-loader {\n  height: 4px;\n  background: linear-gradient(\n    90deg,\n    rgba(253, 187, 33, 0.1) 0%,\n    rgba(253, 187, 33, 1) 25%,\n    rgba(253, 187, 33, 0.5) 50%,\n    rgba(253, 187, 33, 0.5) 75%,\n    rgba(253, 187, 33, 0.1) 100%\n  );\n  background-size: 200% 100%;\n  animation: loading-animation 2s linear infinite;\n}\n\n@keyframes loading-animation {\n  100% {\n    background-position: 0% 0%;\n  }\n  0% {\n    background-position: 200% 0%;\n  }\n}\n");const Yo=e=>{const{toggleChatWindow:t,toggleSize:n,resetChat:r,settings:i,isExpanded:o,isStreaming:s,isMobile:a=!1}=e,{chatTitle:l,assets:c={},theme:u=Ye}=i||{},{closeIcon:d="",maximizeIcon:p="",minimizeIcon:h="",logo:f="",resetIcon:g="",resetModalCloseIcon:m=""}=c,y={header:{backgroundColor:u.primaryColor,color:we}},[b,_]=vr(!1),k=()=>{s||_((e=>!e))},v=()=>{s||(_(!1),r())},w=Nr((()=>U("div",{style:{display:b?"block":"none"},children:U("div",{className:"overlay",id:"overlay",children:U("div",{className:"reset-modal",children:U(Zo,{theme:u,handleReset:v,handleCancel:k,closeIcon:m})})})})),[b]),S=Nr((()=>g?.length?U("img",{src:g,alt:"reset",className:` reset-icon ${s&&"disabled-reset"} `}):"R"),[g,s]),N=Nr((()=>d?.length?U("img",{src:d,alt:"close",className:"close-icon"}):"X"),[d]),E=Nr((()=>p?.length?U("img",{src:o?h:p,alt:o?"minimize":"maximize",className:"resize-icon"}):"M"),[p,o]);return U(x,{children:[w,U("div",{className:"chat-header",style:y.header,"data-testId":"chat-header",children:[U("div",{className:"header-row",children:[U("img",{src:f,alt:"bot icon",className:"header-image",width:24,height:24}),U("span",{className:"title",children:l})]}),U("div",{className:"header-row",children:[U("div",{className:`reset-icon-container ${s&&"disabled-reset"} ${!a&&!s&&"tooltip-container"}`,onClick:k,"aria-label":"Click to start a new chat","data-testId":"chat-reset-icon",...!a&&!s&&{"data-tooltip":It},children:S}),!a&&U("div",{className:"resize-icon tooltip-container",onClick:n,"aria-label":"Click to maximize or minimize the chat","data-testId":"resize-icon","data-tooltip":o?Et:Tt,children:E}),U("div",{className:`close-icon ${!a&&"tooltip-container"}`,onClick:t,"aria-label":"Click to close the chat","data-testId":"chat-close-icon",...!a&&{"data-tooltip":Rt},children:N})]})]}),s&&U("div",{className:"linear-loader"})]})};Mr(".chat-input-container {\n  display: flex;\n  margin: 10px 15px;\n  height: 38px;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.chat-input-box {\n  border: 1px solid #beb9b5;\n  padding-right: 10px;\n  padding-left: 10px;\n  border-radius: 25px;\n  width: 100%;\n}\n\n.input-field {\n  border: 1px solid transparent;\n  background-color: transparent;\n  border-radius: 25px;\n  width: 95%;\n}\n\n.chat-input-box input {\n  flex: 1;\n  padding: 10px;\n  border: 0px solid transparent;\n  font-size: 15px;\n  outline: none;\n  background-color: transparent;\n}\n\n.send-button {\n  cursor: pointer;\n  width: 38px;\n  height: 38px;\n  border-radius: 50%;\n  margin-left: 4px;\n  padding-top: 4px;\n  border: none;\n}\n\n.send-button:hover {\n  background-color: #283049 !important;\n}\n\n.disabled-send-button {\n  opacity: 0.6;\n}\n\n.send-icon {\n  width: 20px;\n  height: 20px;\n  margin: auto;\n}\n\n.chat-input-container .tooltip-container {\n  position: relative;\n  cursor: pointer;\n}\n\n.chat-input-container .tooltip-container::after {\n  content: attr(data-tooltip);\n  position: absolute;\n  bottom: 120%;\n  left: 0%;\n  transform: translateX(-50%);\n  background-color: #333;\n  color: #fff;\n  padding: 5px 8px;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 500;\n  white-space: nowrap;\n  opacity: 0;\n  visibility: hidden;\n  transition:\n    opacity 0.2s ease-in-out,\n    visibility 0.2s ease-in-out;\n  z-index: 1000;\n}\n\n.chat-input-container .tooltip-container:hover::after {\n  opacity: 1;\n  visibility: visible;\n}\n\n.button-container {\n  min-width: 38px;\n}\n\n.bot-suggestions-group {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  gap: 8px;\n  margin: 10px 15px;\n  margin-bottom: 0;\n}\n\n.bot-suggestion {\n  height: 22px;\n  border: solid 1px;\n  border-radius: 6px;\n  padding: 2px 8px;\n  text-align: center;\n  align-content: center;\n  font-weight: 500;\n  font-size: 12px;\n  cursor: pointer;\n}\n");const Ko=e=>{const{handleSendMessage:t,input:n,setInput:r,isDisabled:i=!1,sendIcon:o,theme:s=Ye,placeholder:a,isOpen:l,isExpanded:c,suggestions:u=[]}=e,d={input:{color:ye},button:{backgroundColor:s?.primaryColor},botSuggestionChips:{borderColor:s.primaryColor,backgroundColor:s.chatWindowColor,color:s.textColor,transition:"background-color 0.3s ease"},botSuggestionChipsHover:{borderColor:s.primaryColor,backgroundColor:s.primaryColor,color:s.chatWindowColor,transition:"background-color 0.3s ease"}},p=Qn(),h=Sr(null);wr((()=>{h?.current&&l&&h?.current?.focus()}),[l,c]);const f=Nr((()=>U("div",{className:"bot-suggestions-group",children:u?.map((e=>U(Po,{handleClick:()=>(e=>{t(e.messagePrompt)})(e),text:e.label,customStyle:d.botSuggestionChips,hoveredStyle:d.botSuggestionChipsHover,className:"bot-suggestion"})))})),[u]);return U(x,{children:[Kn(u)&&f,U("div",{className:"chat-input-container",children:[U("div",{className:"chat-input-box",children:U("input",{type:"text",value:n,onInput:e=>{const t=e?.target;r(t?.value||"")},onKeyUp:e=>{"Enter"===e.key&&t()},className:"input-field",style:d.input,placeholder:a,"aria-label":"Type your message to send here","aria-disabled":i,"data-testid":"chat-input-field",ref:h,name:"chat-input-field"})}),U("div",{className:"button-container",children:U("div",{className:`${!p&&"tooltip-visible tooltip-container"}`,...!p&&{"data-tooltip":Ct},children:U("button",{className:`send-button ${i&&"disabled-send-button"}`,onClick:()=>t(),"aria-label":"Click to send your message",disabled:i,style:d.button,"data-testid":"chat-send-button",children:U("img",{src:o,alt:"Send",className:"send-icon"})})})})]})]})};Mr(".chatbot-button {\n  position: fixed;\n  bottom: 40px;\n  right: 20px;\n  width: 64px;\n  height: 64px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  z-index: 1000;\n  transition: transform 0.3s ease;\n}\n\n.hidden-div {\n  visibility: hidden;\n}\n\n.chat-circle-icon {\n  width: 64px;\n  height: 64px;\n  border-radius: 50%;\n  margin: auto;\n  overflow: hidden;\n  padding: 1px;\n}\n\n.chat-display {\n  position: relative;\n  flex: 1;\n  padding: 12px;\n  overflow-y: auto;\n  overflow-x: hidden;\n  font-size: 15px;\n  scroll-behavior: smooth;\n  scrollbar-width: 3px;\n}\n\n.start-conversation {\n  height: 100%;\n  width: 100%;\n  color: #888888;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.chat-window {\n  max-width: 90%;\n  max-height: 90%;\n  height: 70%;\n  position: fixed;\n  bottom: 40px;\n  right: 20px;\n  border-radius: 15px;\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  z-index: 1000;\n  transform-origin: bottom;\n  text-align: left;\n  transition:\n    opacity 0.3s ease-in-out,\n    transform 0.6s ease-out,\n    width 0.4s ease-out,\n    height 0.4s ease-out;\n  transform: translateY(150%);\n}\n\n.chat-window.open {\n  height: 70%;\n  max-width: 90%;\n  max-height: 90%;\n  transform: translateY(0);\n}\n\n.chat-window.closing {\n  transform: translateY(150%);\n}\n\n@keyframes bounce-in {\n  0% {\n    transform: translateY(150%);\n  }\n  60% {\n    transform: translateY(-60px);\n  }\n  80% {\n    transform: translateY(20px);\n  }\n  100% {\n    transform: translateY(0);\n  }\n}\n\n.chat-window.open.small {\n  width: 400px;\n}\n\n.chat-window.open.large {\n  width: 800px;\n  height: 75%;\n}\n\n.typing-row {\n  display: flex;\n  flex-direction: row;\n  align-items: start;\n}\n\n.down-arrow {\n  position: absolute;\n  cursor: pointer;\n  z-index: 100;\n  bottom: 104px;\n  right: 15px;\n  width: 30px;\n  height: 30px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 50%;\n  overflow: hidden;\n  background: rgba(56, 94, 120, 0.2);\n  backdrop-filter: blur(10px);\n  -webkit-backdrop-filter: blur(10px);\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n}\n\n.down-arrow img {\n  padding-top: 2px;\n}\n\n.powered-by {\n  display: flex;\n  justify-content: center;\n  margin-bottom: 15px;\n  font-size: 13px;\n}\n\n.chat-display p {\n  font-size: 15px;\n  line-height: 21px;\n  font-weight: 400;\n  padding: 0px;\n  margin: 0px;\n}\n\n.loading-older-messages {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  margin: auto;\n  font-size: 12px;\n  padding-bottom: 8px;\n}\n\n@media only screen and (max-width: 600px) {\n  .chat-window {\n    height: 75% !important;\n  }\n}\n\n.no-click {\n  pointer-events: none;\n}\n\n.card-container-animation {\n  animation: loadingOpacity 2s infinite;\n}\n\n@keyframes loadingOpacity {\n  0% {\n    opacity: 0.2;\n  }\n  50% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 0.2;\n  }\n}\n\n* {\n  box-sizing: border-box;\n  -webkit-box-sizing: border-box;\n  -ms-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n}\n");const Xo=e=>{const{settings:t,backendChatUrl:n,backendBaseUrl:r}=e,i=t?.theme||{},o=t?.assets||{},s=t?.preloadAssets||[],a={...Ye,...i},l=(a.primaryColor,a.chatWindowColor,{backgroundColor:a.chatWindowColor,bottom:t?.position?.bottom}),c=(a.primaryColor,o?.downIcon||""),u=Qn(),[d,p]=vr("true"===Gn({key:nn.IS_CHAT_BOT_OPEN})),[h,f]=vr(!0),[g,m]=vr(!1),[y,b]=vr(!1),[x,_]=vr([]),k=Sr(null),{messages:v,streaming:w,input:S,isApiMessagesLoading:N,previousMessages:E,currentMessageData:T,currentEvent:R,updateMessages:I,resetChat:C,setInput:A,handleChatContainerScroll:O,handleStorageChange:M,handleSendMessage:D,setMessages:L}=(({backendBaseUrl:e,backendChatUrl:t,isOpen:n,settings:r,setIsOpen:i,setSuggestionList:o=()=>{},chatContainerRef:s})=>{const[a,l]=vr([]),[c,u]=vr([]),[d,p]=vr(),[h,f]=vr(""),[g,m]=vr(""),[y,b]=vr(!1),[x,_]=vr(!1),[k,v]=vr("");let w="",S=null,N=!1,E={};wr((()=>{const e=()=>{document.hidden||I()},t=()=>{I()};return document.addEventListener("visibilitychange",e),window.addEventListener("focus",t),()=>{document.removeEventListener("visibilitychange",e),window.removeEventListener("focus",t)}}),[]),wr((()=>{const e=e=>{b(!1),Jn({key:nn.IS_STREAMING,value:"false"}),qn.error(JSON.stringify({...Ve[Ze.UNHANDLED_ERROR],error:e}))};return window.addEventListener("error",e),window.addEventListener("unhandledrejection",e),()=>{window.removeEventListener("error",e),window.removeEventListener("unhandledrejection",e)}}),[]),wr((()=>{const e=ir(),t=rr(),r=t&&new Date(t)<new Date;e||y||!n?n&&e&&!a.length?T(e):n&&e&&a.length>0&&r&&I():C()}),[n]);const T=async t=>{b(!0);try{const n=Xn(e)?e:"https://keyvalue-core-svc.milestonedev.info",r=await sr(`${n}/${St}/thread-id/${t}?timestamp=${Date.now()}`,We.GET),i=r?.data?.thread?.isExpired;if(i)return D(),!0;R(t,n),Jn({key:nn.THREAD,value:JSON.stringify(r.data.thread)})}catch{qn.warn(Ve[Ze.ERROR_IN_PARSING]?.message)}finally{b(!1)}return!1},R=async(e,t)=>{_(!0);const n=await sr(`${t}/${Nt}?threadId=${e}&limit=5&timestamp=${Date.now()}`,We.GET);if(_(!1),!n)return;const r=nr(n.messages);l(r),Jn({key:nn.MESSAGES,value:JSON.stringify(r)}),v(n?.pagination?.nextCursor||"")},I=()=>{const e=ir(),t=rr(),n="true"===Gn({key:nn.IS_CHAT_BOT_OPEN});e&&t&&new Date(t)<new Date&&n&&T(e)},C=async()=>{try{b(!0);const n=await sr(`${Xn(e)?e:"https://keyvalue-core-svc.milestonedev.info"}/${St}?timestamp=${Date.now()}`,We.POST);if(n?.data?.thread?.threadId){const e=n.data.thread.threadId;Jn({key:nn.THREAD,value:JSON.stringify(n.data.thread)}),qn.info(tt),Jn({key:nn.IS_STREAMING,value:"true"});const i={"x-site-id":r?.miSessionInfo?.siteId,"x-site-url":r?.miSessionInfo?.siteURL},o={chatId:e,userMessage:"",timeout:r?.streamTimeout,apiUrl:`${Xn(t)?t:"https://keyvalue-ai-svc.milestonedev.info"}/stream`,headers:i,onStreamMessage:O,onStreamMessageError:M};v(""),await ar(o)}}catch{qn.warn(Ve[Ze.ERROR_IN_PARSING]?.message)}finally{b(!1)}},A=(e,t)=>{const n={text:e,type:gt,timestamp:(new Date).getTime(),messageStructure:t};return{userMessage:S||void 0,aiMessage:n}},O=e=>{const t=e?.data||"",n=e?.event||"",r="end"===n,i="init"===n,o="delta"===n,s="final"===n,a="error"===n,c="feedback"===n,u={messageId:E?.run_id,threadId:ir(),text:w,type:gt,timestamp:(new Date).getTime(),shouldShowFeedback:E?.shouldShowFeedback,messageStructure:N?rn.JSON:rn.MARKDOWN};if(n.length>0&&f(n),r){qn.info(`${rt} ${u?.text}`);const e={userMessage:S||void 0,aiMessage:u};l((t=>[...t,e])),or(e,zt),w="",S=null,N=!1,p(void 0),b(!1),Jn({key:nn.IS_STREAMING,value:"false"})}else if(t?.length>0)try{if(i)w=t,p(A(w,rn.MARKDOWN));else if(o)try{const e=JSON.parse(t);w+=e?.content,e?.type===rn.JSON_TOKEN?(N=!0,p(A(w,rn.JSON_TOKEN))):p(A(w,rn.MARKDOWN))}catch{qn.warn(Ve[Ze.ERROR_IN_PARSING]?.message)}else if(s)try{const e=JSON.parse(t);if(e?.type===rn.JSON){N=!0,w=e?.content;const t=JSON.stringify(e?.content);p(A(t,rn.JSON))}else w=e?.content,N=!1,p(A(e?.content,rn.MARKDOWN))}catch{qn.warn(Ve[Ze.ERROR_IN_PARSING]?.message)}else if(a)try{const e=JSON.parse(t);if(e?.type===rn.ERROR){qn.info(`${rt} ${e?.content?.message}`);const t=e?.content?.shouldRetry&&Xn(w)?w:e?.content?.message,n=t===w?rn.JSON:rn.MARKDOWN,r={messageId:`error-${(new Date).getTime()}`,threadId:ir(),type:mt,text:t,timestamp:(new Date).getTime(),shouldShowFeedback:!1,messageStructure:n,failed:e?.content?.shouldRetry},i={userMessage:S||void 0,aiMessage:r};l((e=>[...e,i])),p(void 0),b(!1),or(i,zt),Jn({key:nn.IS_STREAMING,value:"false"}),w="",S=null,N=!1}else M(Ve[Ze.ERROR_IN_PARSING]?.message)}catch{M(Ve[Ze.ERROR_IN_PARSING]?.message)}else c&&(E=JSON.parse(t))}catch{qn.warn(Ve[Ze.ERROR_IN_PARSING]?.message)}},M=e=>{const t={messageId:`error-${(new Date).getTime()}`,threadId:ir(),text:w,type:gt,timestamp:(new Date).getTime(),shouldShowFeedback:!1,messageStructure:N?rn.JSON:rn.MARKDOWN,failed:!0},n=!Xn(w);let r;S&&(r={...S,failed:n,isMessageSendClientError:!navigator.onLine});const i={};Xn(w)&&(i.aiMessage=t),r&&(i.userMessage=r),l((e=>[...e,i])),p(void 0),or(i,zt),b(!1),Jn({key:nn.IS_STREAMING,value:"false"}),w="",S=null,N=!1,qn.error(JSON.stringify({...Ve[Ze.NETWORK_ERROR],error:e}))},D=()=>{Wn({key:nn.MESSAGES}),Wn({key:nn.THREAD}),l([]),u([]),m(""),o([]),C()};return{streaming:y,messages:a,input:g,isApiMessagesLoading:x,previousMessages:c,currentMessageData:d,currentEvent:h,setMessages:l,updateMessages:({feedback:e,messageId:t})=>{if(!Gn({key:nn.IS_STREAMING})){const n=a.map((n=>{if(n?.aiMessage?.messageId!==t)return n;const r=n.aiMessage;return r.feedback=e,{...n,aiMessage:r}}));l(n)}},resetChat:D,setInput:m,handleSendMessage:async e=>{let n=g;if(o([]),"string"==typeof e&&(n=e),n?.trim()?.length>0&&!y){const e={text:n,type:yt,timestamp:(new Date).getTime(),threadId:ir()};S=e,qn.info(`${it} ${n}`),p({userMessage:e}),or({userMessage:e}),m(""),b(!0),Jn({key:nn.IS_STREAMING,value:"true"});const i=ir();try{const e={"x-site-id":r?.miSessionInfo?.siteId,"x-site-url":r?.miSessionInfo?.siteURL},o={chatId:i,userMessage:n,timeout:r?.streamTimeout,apiUrl:`${Xn(t)?t:"https://keyvalue-ai-svc.milestonedev.info"}/stream`,headers:e,onStreamMessage:O,onStreamMessageError:M,onTimeout:M};await ar(o)}catch(e){qn.error(JSON.stringify({message:at,error:e}))}finally{b(!1),Jn({key:nn.IS_STREAMING,value:"false"})}}},handleStorageChange:e=>{try{if(e.key===nn.MESSAGES){const t=JSON.parse(e.newValue||"[]");5===t.length&&v(new Date(t[0].userMessage?.timestamp).toISOString());const n=ir();0===t.length&&n&&T(n),l(t),u([])}else if(e.key===nn.IS_STREAMING){const t="true"===e.newValue;b(t)}e.key===nn.IS_CHAT_BOT_OPEN&&i("true"===Gn({key:nn.IS_CHAT_BOT_OPEN})),e.key===nn.THREAD&&u([])}catch{qn.warn(Ve[Ze.ERROR_IN_PARSING]?.message)}},handleChatContainerScroll:async()=>{if(!s.current)return;const{scrollTop:t}=s.current;if(0!==t||a.length<5||!k)return;const n=ir();_(!0);try{const t=Xn(e)?e:"https://keyvalue-core-svc.milestonedev.info",r=await sr(`${t}/${Nt}?threadId=${n}&limit=5&cursor=${k}&timestamp=${Date.now()}`,We.GET);if(!r)return;const i=nr(r.messages);u((e=>[...i,...e])),v(r?.pagination?.nextCursor||"")}catch(e){qn.error(JSON.stringify({message:pt,error:e}))}finally{_(!1)}}}})({backendBaseUrl:r,backendChatUrl:n,isOpen:d,chatContainerRef:k,settings:t,setIsOpen:p,setSuggestionList:_});wr((()=>(Jn({key:nn.IS_CHAT_BOT_OPEN,value:`${d}`}),document.addEventListener("keyup",z),()=>{document.removeEventListener("keyup",z)})),[d,g]),wr((()=>{const e=k.current;return e&&e.addEventListener("scroll",P),window.addEventListener("storage",M),()=>{e&&e.removeEventListener("scroll",P),window.removeEventListener("storage",M)}}),[]),wr((()=>{$()}),[v?.length]),wr((()=>{w||setTimeout((()=>{$()}),1e3)}),[w]);const z=e=>{e.key===xt&&d?(e.preventDefault(),B()):e.altKey&&e.key.toLowerCase()===bt&&!d?(e.preventDefault(),p(!0)):u||(e.altKey&&e.key.toLowerCase()===_t&&!g?(qn.info(`${st}`),e.preventDefault(),m(!0)):e.altKey&&e.key.toLowerCase()===_t&&g&&(qn.info(`${ot}`),e.preventDefault(),m(!1)))},P=()=>{if(k.current){const{scrollTop:e,scrollHeight:t,clientHeight:n}=k.current;f(e+n>=t-5)}},$=()=>{k.current&&(k.current.scrollTop=k.current.scrollHeight)},B=()=>{if(qn.info(`${nt}  ${d?"closed":"open"}`),d){const e=window?.location?.href,n={...Dt,label:e};tr(n,t?.PushToGTM_global),b(!0),setTimeout((()=>{p(!1),b(!1)}),400)}else p(!0)},H=()=>{u||m((e=>!e))},F=function(e,t){let n=!1;return function(...r){n||(e.apply(this,r),n=!0,setTimeout((()=>{n=!1}),t))}}((()=>{const e=window?.location?.href,n={...Ot,label:e};tr(n,t?.PushToGTM_global),p(!0)}),2e3),j=e=>{_(e||[])},G=e=>{D(e),setTimeout((()=>{$()}),100)},J=e=>{e&&(L((t=>t?.filter((t=>t?.userMessage?.timestamp!==e?.userMessage?.timestamp)))),or(e,Pt),G(e?.userMessage?.text))},W=Nr((()=>U(Vo,{toggleChatWindow:F,settings:t})),[d]),q=Nr((()=>h||w?null:U("div",{className:"down-arrow",onClick:$,children:U("img",{src:c,alt:"Down",width:14,height:14})})),[h]),V=Nr((()=>U(Ko,{handleSendMessage:G,input:S,setInput:A,isDisabled:w,placeholder:t?.chatPlaceholder,sendIcon:o?.sendIcon,theme:a,isOpen:d,isExpanded:g,suggestions:x})),[S,w,t,o,a,d,g]),Z=Nr((()=>U(qo,{streaming:w,chatContainerRef:k,settings:t,handleChatContainerScroll:O,handleSendMessage:G,isApiMessagesLoading:N,messages:v,previousMessages:E,currentMessageData:T,currentEvent:R,isExpanded:g,setSuggestions:j,updateMessages:I,handleRetry:J})),[w,v,E,T,R,k,t,g,N]),Y=Nr((()=>U(Yo,{toggleChatWindow:B,toggleSize:H,resetChat:C,settings:t,isStreaming:w,isExpanded:g,isMobile:u})),[g,u,w,t]),K=Nr((()=>Kn(s)&&U("div",{className:"hidden-div",children:s?.map((e=>U("img",{src:e})))})),[t?.preloadAssets]);return U("div",{children:[K,W,U("div",{className:`chat-window ${d&&"open "+(g?"large":"small")} ${y&&"closing"}`,style:{...l},"data-testid":"chat-window",children:[Y,Z,q,V]})]})};class Qo{settingsConfig;miSessionInfo;backendBaseUrl;backendChatUrl;constructor(e){const{miSessionInfo:t,settings:n={},backendBaseUrl:r="",backendChatUrl:i=""}=e;this.settingsConfig={...n,miSessionInfo:t},this.backendBaseUrl=r,this.miSessionInfo=t,this.backendChatUrl=i,this.setLoggerFlag(n?.logEnabled),this.initUI()}setLoggerFlag(e){e?Jn({key:nn.LOGGER_ENABLED,value:"true"}):Wn({key:nn.LOGGER_ENABLED})}async initUI(){try{qn.info(lt);const e=await sr(`${Xn(this.backendBaseUrl)?this.backendBaseUrl:"https://keyvalue-core-svc.milestonedev.info"}/${wt}`,We.POST,{siteId:this.miSessionInfo.siteId,siteUrl:this.miSessionInfo.siteURL});if(!e)throw new Error(Ve[Ze.CONFIGURATION_ERROR]?.message);const t=await(e?.data);if(t?.site){qn.info(et);const e=document.createElement("div");document.body.appendChild(e);const t=Zn(Ke,this.settingsConfig||{});$(U(Xo,{settings:t,backendChatUrl:this.backendChatUrl,backendBaseUrl:this.backendBaseUrl}),e)}}catch(e){qn.error(JSON.stringify({message:ct,error:e}))}}}window&&(window.AiChatbot=Qo),e.AiChatbot=Qo,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ai-chatbot.js.map
